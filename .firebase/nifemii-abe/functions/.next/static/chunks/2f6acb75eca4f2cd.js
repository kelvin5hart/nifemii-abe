(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,38448,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(36180);var s=e.i(98925),n=e.i(59141),r=e.i(57951);let o={pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50",confirmed:"bg-blue-500/20 text-blue-400 border-blue-500/50",completed:"bg-green-500/20 text-green-400 border-green-500/50",cancelled:"bg-red-500/20 text-red-400 border-red-500/50",rescheduled:"bg-purple-500/20 text-purple-400 border-purple-500/50"},l={consultation:"Consultation",fitting:"Fitting",pickup:"Pickup","fabric-dropoff":"Fabric Drop-off"},i={consultation:"Discuss your style ideas and get expert recommendations",fitting:"Try on your outfit and make any necessary adjustments",pickup:"Collect your completed order from the studio","fabric-dropoff":"Bring your fabric for a sew-only order"},c={workingDays:["monday","tuesday","wednesday","thursday","friday","saturday"],workingHours:{start:"10:00",end:"18:00"},slotDuration:30,blockedDates:[],blockedTimeSlots:[]};function m(){let{user:e}=(0,r.useAuth)(),[m,d]=(0,a.useState)([]),[f,x]=(0,a.useState)(c),[p,b]=(0,a.useState)(!0),[h,u]=(0,a.useState)(!1),[y,v]=(0,a.useState)(!1),[j,g]=(0,a.useState)("consultation"),[N,w]=(0,a.useState)(""),[k,S]=(0,a.useState)(""),[C,D]=(0,a.useState)(""),[A,T]=(0,a.useState)(null),[B,P]=(0,a.useState)(!1),[L,$]=(0,a.useState)(!1),[U,E]=(0,a.useState)(""),[R,z]=(0,a.useState)(""),[I,F]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!e?.phone)return;let t=(0,s.query)((0,s.collection)(n.db,"appointments"),(0,s.where)("userPhone","==",e.phone),(0,s.orderBy)("date","desc")),a=(0,s.onSnapshot)(t,e=>{d(e.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}})),b(!1)});return()=>a()},[e?.phone]),(0,a.useEffect)(()=>{let e=(0,s.onSnapshot)((0,s.doc)(n.db,"settings","main"),e=>{if(e.exists()){let t=e.data();t.availability&&x({...c,...t.availability,blockedTimeSlots:t.availability.blockedTimeSlots||[]})}});return()=>e()},[]);let[H,O]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=(0,s.query)((0,s.collection)(n.db,"appointments"),(0,s.where)("status","in",["pending","confirmed","rescheduled"])),t=(0,s.onSnapshot)(e,e=>{O(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>t()},[]);let q=()=>{let e=[],[t,a]=f.workingHours.start.split(":").map(Number),[s,n]=f.workingHours.end.split(":").map(Number),r=f.slotDuration,o=60*t+a,l=60*s+n;for(;o<l;){let t=Math.floor(o/60),a=o%60;e.push(`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`),o+=r}return e},K=(e,t)=>{let a=f.blockedTimeSlots||[],s=parseInt(t.replace(":",""));return a.some(t=>{if(t.date!==e)return!1;let a=parseInt(t.startTime.replace(":","")),n=parseInt(t.endTime.replace(":",""));return s>=a&&s<n})},M=(e,t,a)=>H.some(s=>(!a||s.id!==a)&&s.date===e&&s.timeSlot===t),V=(e,t,a)=>K(e,t)||M(e,t,a),Y=(e,t)=>q().filter(a=>!V(e,a,t)),G=e=>{let t=new Date(e).toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();return!(!f.workingDays.includes(t)||f.blockedDates.includes(e))},W=async()=>{if(e?.phone&&N&&k){v(!0);try{await (0,s.addDoc)((0,s.collection)(n.db,"appointments"),{userId:e.id,userPhone:e.phone,userName:e.name||null,type:j,date:N,timeSlot:k,status:"pending",notes:C||null,createdBy:"customer",createdAt:s.Timestamp.now()}),u(!1),g("consultation"),w(""),S(""),D("")}catch(e){console.error("Error booking appointment:",e)}finally{v(!1)}}},J=e=>new Date(e).toLocaleDateString("en-NG",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),Q=m.filter(e=>new Date(e.date)>=new Date&&!["cancelled","completed"].includes(e.status)),X=m.filter(e=>new Date(e.date)<new Date||["cancelled","completed"].includes(e.status)),Z=async()=>{if(A){F(!0);try{await (0,s.updateDoc)((0,s.doc)(n.db,"appointments",A.id),{status:"cancelled",updatedAt:s.Timestamp.now()}),P(!1),T(null)}catch(e){console.error("Error cancelling appointment:",e)}finally{F(!1)}}},_=async()=>{if(A&&U&&R){F(!0);try{await (0,s.updateDoc)((0,s.doc)(n.db,"appointments",A.id),{date:U,timeSlot:R,status:"pending",updatedAt:s.Timestamp.now()}),$(!1),T(null),E(""),z("")}catch(e){console.error("Error rescheduling appointment:",e)}finally{F(!1)}}},ee=new Date().toISOString().split("T")[0];return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"Appointments"}),(0,t.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:"Schedule and manage your appointments"})]}),(0,t.jsx)("button",{onClick:()=>u(!0),className:"bg-[#c9a962] text-[#0a0a0a] px-4 py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors",children:"Book Appointment"})]}),p?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"text-[#888888]",children:"Loading appointments..."})}):0===m.length?(0,t.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-12 text-center",children:[(0,t.jsx)("svg",{className:"w-16 h-16 text-[#2a2a2a] mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,t.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)] mb-4",children:"No appointments scheduled"}),(0,t.jsx)("button",{onClick:()=>u(!0),className:"inline-block bg-[#c9a962] text-[#0a0a0a] px-6 py-2 font-[family-name:var(--font-montserrat)] text-sm uppercase tracking-wider hover:bg-[#d4b87a] transition-colors",children:"Book Your First Appointment"})]}):(0,t.jsxs)("div",{className:"space-y-8",children:[Q.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:["Upcoming (",Q.length,")"]}),(0,t.jsx)("div",{className:"space-y-4",children:Q.map(e=>(0,t.jsx)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsxs)("div",{className:"text-center bg-[#0a0a0a] p-3 border border-[#1a1a1a]",children:[(0,t.jsx)("p",{className:"text-2xl text-[#c9a962] font-[family-name:var(--font-cormorant)]",children:new Date(e.date).getDate()}),(0,t.jsx)("p",{className:"text-xs text-[#888888] font-[family-name:var(--font-montserrat)] uppercase",children:new Date(e.date).toLocaleDateString("en-US",{month:"short"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:l[e.type]}),(0,t.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[e.timeSlot," •"," ",new Date(e.date).toLocaleDateString("en-NG",{weekday:"long"})]}),e.notes&&(0,t.jsxs)("p",{className:"text-sm text-[#666666] mt-1 font-[family-name:var(--font-montserrat)]",children:["Note: ",e.notes]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:`px-3 py-1 text-xs border ${o[e.status]} font-[family-name:var(--font-montserrat)]`,children:e.status}),["pending","confirmed"].includes(e.status)&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{T(e),E(e.date),z(e.timeSlot),$(!0)},className:"text-[#c9a962] text-sm font-[family-name:var(--font-montserrat)] hover:underline",children:"Reschedule"}),(0,t.jsx)("button",{onClick:()=>{T(e),P(!0)},className:"text-red-400 text-sm font-[family-name:var(--font-montserrat)] hover:underline",children:"Cancel"})]})]})]})},e.id))})]}),X.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:"Past Appointments"}),(0,t.jsx)("div",{className:"bg-[#111111] border border-[#1a1a1a] divide-y divide-[#1a1a1a]",children:X.map(e=>(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:l[e.type]}),(0,t.jsxs)("span",{className:"text-[#888888] text-sm ml-3 font-[family-name:var(--font-montserrat)]",children:[J(e.date)," at ",e.timeSlot]})]}),(0,t.jsx)("span",{className:`px-2 py-0.5 text-xs border ${o[e.status]} font-[family-name:var(--font-montserrat)]`,children:e.status})]})},e.id))})]})]}),h&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-[#111111] border-b border-[#1a1a1a] px-6 py-4 flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"Book Appointment"}),(0,t.jsx)("button",{onClick:()=>u(!1),className:"text-[#888888] hover:text-[#f5f5f5]",children:"✕"})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-[#888888] mb-3 font-[family-name:var(--font-montserrat)]",children:"What do you need?"}),(0,t.jsx)("div",{className:"space-y-2",children:Object.keys(l).map(e=>(0,t.jsxs)("button",{onClick:()=>g(e),className:`w-full text-left p-3 border transition-colors ${j===e?"border-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] hover:border-[#3a3a3a]"}`,children:[(0,t.jsx)("p",{className:`font-[family-name:var(--font-montserrat)] ${j===e?"text-[#c9a962]":"text-[#f5f5f5]"}`,children:l[e]}),(0,t.jsx)("p",{className:"text-xs text-[#888888] font-[family-name:var(--font-montserrat)] mt-1",children:i[e]})]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select Date"}),(0,t.jsx)("input",{type:"date",value:N,onChange:e=>{w(e.target.value),S("")},min:ee,className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-2 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none"}),N&&!G(N)&&(0,t.jsx)("p",{className:"text-red-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"This date is not available. Please select another date."})]}),N&&G(N)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select Time"}),(0,t.jsx)("div",{className:"grid grid-cols-4 gap-2",children:q().map(e=>{let a=K(N,e),s=M(N,e),n=a||s;return(0,t.jsxs)("button",{onClick:()=>!n&&S(e),disabled:n,className:`py-2 text-sm border font-[family-name:var(--font-montserrat)] transition-colors ${n?"border-[#1a1a1a] text-[#444444] bg-[#1a1a1a] cursor-not-allowed":k===e?"border-[#c9a962] text-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] text-[#888888] hover:border-[#3a3a3a]"}`,children:[e,s&&!a&&(0,t.jsx)("span",{className:"block text-[9px]",children:"Booked"}),a&&(0,t.jsx)("span",{className:"block text-[9px]",children:"Unavailable"})]},e)})}),0===Y(N).length&&(0,t.jsx)("p",{className:"text-orange-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"No available time slots on this date. Please select another date."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Additional Notes (optional)"}),(0,t.jsx)("textarea",{value:C,onChange:e=>D(e.target.value),rows:2,className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-2 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none resize-none",placeholder:"Any special requests or notes..."})]}),N&&k&&(0,t.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,t.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"Your Appointment"}),(0,t.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:l[j]}),(0,t.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[J(N)," at ",k]})]}),(0,t.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,t.jsx)("button",{onClick:()=>u(!1),className:"flex-1 border border-[#2a2a2a] text-[#888888] py-2 font-[family-name:var(--font-montserrat)] hover:border-[#3a3a3a] hover:text-[#f5f5f5] transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:W,disabled:y||!N||!k||!G(N)||V(N,k),className:"flex-1 bg-[#c9a962] text-[#0a0a0a] py-2 font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50",children:y?"Booking...":"Confirm Booking"})]})]})]})}),B&&A&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-sm p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:"Cancel Appointment"}),(0,t.jsxs)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)] mb-2",children:["Are you sure you want to cancel your"," ",(0,t.jsx)("span",{className:"text-[#f5f5f5]",children:l[A.type]})," ","appointment?"]}),(0,t.jsxs)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)] mb-6",children:["Scheduled for"," ",(0,t.jsxs)("span",{className:"text-[#f5f5f5]",children:[J(A.date)," at ",A.timeSlot]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>{P(!1),T(null)},disabled:I,className:"flex-1 border border-[#2a2a2a] text-[#f5f5f5] py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-[#1a1a1a] transition-colors disabled:opacity-50",children:"Keep Appointment"}),(0,t.jsx)("button",{onClick:Z,disabled:I,className:"flex-1 bg-red-500 text-white py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-red-600 transition-colors disabled:opacity-50",children:I?"Cancelling...":"Yes, Cancel"})]})]})}),L&&A&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-[#111111] border-b border-[#1a1a1a] px-6 py-4 flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"Reschedule Appointment"}),(0,t.jsx)("button",{onClick:()=>{$(!1),T(null),E(""),z("")},className:"text-[#888888] hover:text-[#f5f5f5]",children:"✕"})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,t.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"Current Appointment"}),(0,t.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:l[A.type]}),(0,t.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[J(A.date)," at ",A.timeSlot]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select New Date"}),(0,t.jsx)("input",{type:"date",value:U,onChange:e=>{E(e.target.value),z("")},min:ee,className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-2 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none"}),U&&!G(U)&&(0,t.jsx)("p",{className:"text-red-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"This date is not available. Please select another date."})]}),U&&G(U)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select New Time"}),(0,t.jsx)("div",{className:"grid grid-cols-4 gap-2",children:q().map(e=>{let a=K(U,e),s=M(U,e,A?.id),n=a||s;return(0,t.jsxs)("button",{onClick:()=>!n&&z(e),disabled:n,className:`py-2 text-sm border font-[family-name:var(--font-montserrat)] transition-colors relative ${n?"border-[#1a1a1a] text-[#444444] bg-[#1a1a1a] cursor-not-allowed":R===e?"border-[#c9a962] text-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] text-[#888888] hover:border-[#3a3a3a]"}`,children:[(0,t.jsx)("span",{className:n?"line-through":"",children:e}),s&&!a&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 text-[8px] bg-orange-500/80 text-white px-1 rounded",children:"Booked"}),a&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 text-[8px] bg-red-500/80 text-white px-1 rounded",children:"Unavailable"})]},e)})}),0===Y(U,A?.id).length&&(0,t.jsx)("p",{className:"text-orange-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"No available time slots on this date. Please select another date."})]}),U&&R&&(0,t.jsxs)("div",{className:"bg-[#c9a962]/10 p-4 border border-[#c9a962]/30",children:[(0,t.jsx)("p",{className:"text-xs text-[#c9a962] mb-2 font-[family-name:var(--font-montserrat)]",children:"New Appointment"}),(0,t.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:l[A.type]}),(0,t.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[J(U)," at ",R]})]}),(0,t.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,t.jsx)("button",{onClick:()=>{$(!1),T(null),E(""),z("")},disabled:I,className:"flex-1 border border-[#2a2a2a] text-[#888888] py-2 font-[family-name:var(--font-montserrat)] hover:border-[#3a3a3a] hover:text-[#f5f5f5] transition-colors disabled:opacity-50",children:"Cancel"}),(0,t.jsx)("button",{onClick:_,disabled:I||!U||!R||!G(U)||V(U,R,A?.id)||U===A.date&&R===A.timeSlot,className:"flex-1 bg-[#c9a962] text-[#0a0a0a] py-2 font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50",children:I?"Rescheduling...":"Confirm Reschedule"})]})]})]})})]})})}e.s(["default",()=>m])}]);