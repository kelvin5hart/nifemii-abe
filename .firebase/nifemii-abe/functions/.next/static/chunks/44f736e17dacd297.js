(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69439,e=>{"use strict";var a=e.i(43476),t=e.i(71645),r=e.i(18566),s=e.i(57688),n=e.i(22016),l=e.i(75144),o=e.i(57951);e.i(36180);var i=e.i(98925),c=e.i(59141);let m=e=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0}).format(e),d=["Abia","Adamawa","Akwa Ibom","Anambra","Bauchi","Bayelsa","Benue","Borno","Cross River","Delta","Ebonyi","Edo","Ekiti","Enugu","FCT","Gombe","Imo","Jigawa","Kaduna","Kano","Katsina","Kebbi","Kogi","Kwara","Lagos","Nasarawa","Niger","Ogun","Ondo","Osun","Oyo","Plateau","Rivers","Sokoto","Taraba","Yobe","Zamfara"];function f(){let e=(0,r.useRouter)(),{items:f,subtotal:x,clearCart:h}=(0,l.useCart)(),{user:u}=(0,o.useAuth)(),[p,b]=(0,t.useState)(1),[y,v]=(0,t.useState)(!1),[j,N]=(0,t.useState)(null),[g,k]=(0,t.useState)({name:"",phone:"",email:""}),[w,C]=(0,t.useState)("delivery"),[P,A]=(0,t.useState)({street:"",city:"",state:"Lagos",landmark:""}),[S,$]=(0,t.useState)("online"),[D,E]=(0,t.useState)(!1);(0,t.useEffect)(()=>{u&&k({name:u.name||"",phone:u.phone||"",email:u.email||""})},[u]),(0,t.useEffect)(()=>{(async()=>{try{let e=await (0,i.getDoc)((0,i.doc)(c.db,"settings","main"));e.exists()&&N(e.data().delivery)}catch(e){console.error("Error fetching settings:",e)}})()},[]);let I=(()=>{if("pickup"===w)return 0;if(!j)return 2e3;if(j.freeAbove&&x>=j.freeAbove)return 0;switch(j.type){case"free":return 0;case"flat":return j.flatFee||2e3;case"state-based":return j.stateFees?.[P.state]||3e3;default:return 2e3}})(),O=x+I;(0,t.useEffect)(()=>{0===f.length&&e.push("/shop")},[f,e]);let T=()=>"pickup"===w||P.street&&P.city&&P.state,F=async()=>{if(g.name&&g.phone&&T()){if(0===f.length){alert("Your cart is empty. Please add items before placing an order."),e.push("/shop");return}v(!0);try{let a=f.map(e=>({productId:e.productId,productName:e.productName,sku:e.sku||void 0,size:e.size,quantity:e.quantity,price:e.salePrice||e.price,image:e.image||"/images/placeholder.jpg"})),t={userId:u?.id||"",userPhone:g.phone,userName:g.name,userEmail:g.email||null,type:"ready-to-wear",status:"pending",items:a,pricing:{subtotal:x,deliveryFee:I,totalAmount:O},deliveryMethod:w,deliveryAddress:"delivery"===w?{street:P.street,city:P.city,state:P.state,landmark:P.landmark||null}:null,paymentMethod:S,createdBy:u?.id||"guest",createdAt:i.Timestamp.now(),updatedAt:i.Timestamp.now()},r=await (0,i.addDoc)((0,i.collection)(c.db,"orders"),t);if("online"===S)try{let e=await fetch("/api/paystack/initialize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:g.email||`${g.phone}@guest.nifemiiabe.com`,amount:O,orderId:r.id,metadata:{customerName:g.name,customerPhone:g.phone}})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to initialize payment");h(),window.location.href=a.authorization_url;return}catch(e){console.error("Paystack error:",e),alert("Payment initialization failed. Your order has been saved. Please try paying later or contact us.")}h(),e.push(`/checkout/success?orderId=${r.id}`)}catch(e){console.error("Error creating order:",e),alert("Failed to place order. Please try again.")}finally{v(!1)}}};return 0===f.length?(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] pt-24 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-[#c9a962] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-[#888888]",children:"Redirecting..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] pt-24 pb-16",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)(n.default,{href:"/shop",className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)] hover:text-[#c9a962] transition-colors",children:"â† Back to Shop"}),(0,a.jsx)("h1",{className:"text-3xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mt-4",children:"Checkout"})]}),(0,a.jsx)("div",{className:"flex items-center justify-center mb-8",children:[{num:1,label:"Information"},{num:2,label:"Delivery"},{num:3,label:"Payment"}].map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-[family-name:var(--font-montserrat)] ${p>=e.num?"bg-[#c9a962] text-[#0a0a0a]":"bg-[#2a2a2a] text-[#888888]"}`,children:e.num}),(0,a.jsx)("span",{className:`ml-2 text-sm font-[family-name:var(--font-montserrat)] hidden sm:inline ${p>=e.num?"text-[#f5f5f5]":"text-[#888888]"}`,children:e.label}),t<2&&(0,a.jsx)("div",{className:`w-8 sm:w-16 h-0.5 mx-2 sm:mx-4 ${p>e.num?"bg-[#c9a962]":"bg-[#2a2a2a]"}`})]},e.num))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[1===p&&(0,a.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-6",children:"Contact Information"}),!u&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-[#0a0a0a] border border-[#2a2a2a]",children:(0,a.jsxs)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:["Already have an account?"," ",(0,a.jsx)(n.default,{href:"/account/login",className:"text-[#c9a962] hover:underline",children:"Log in"})," ","for faster checkout."]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Full Name *"}),(0,a.jsx)("input",{type:"text",value:g.name,onChange:e=>k({...g,name:e.target.value}),className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-3 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Phone Number *"}),(0,a.jsx)("input",{type:"tel",value:g.phone,onChange:e=>k({...g,phone:e.target.value}),className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-3 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none",placeholder:"08012345678",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Email (optional)"}),(0,a.jsx)("input",{type:"email",value:g.email,onChange:e=>k({...g,email:e.target.value}),className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-3 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none"})]})]}),(0,a.jsx)("button",{onClick:()=>g.name&&g.phone&&b(2),disabled:!(g.name&&g.phone),className:"w-full mt-6 bg-[#c9a962] text-[#0a0a0a] py-3 text-sm tracking-[0.1em] uppercase font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue to Delivery"})]}),2===p&&(0,a.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-6",children:"Delivery Method"}),(0,a.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,a.jsxs)("label",{className:`flex items-start gap-4 p-4 border cursor-pointer transition-colors ${"delivery"===w?"border-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] hover:border-[#3a3a3a]"}`,children:[(0,a.jsx)("input",{type:"radio",name:"deliveryMethod",checked:"delivery"===w,onChange:()=>C("delivery"),className:"mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:"Delivery"}),(0,a.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:0===I?"Free delivery":`Delivery fee: ${m(I)}`})]})]}),(0,a.jsxs)("label",{className:`flex items-start gap-4 p-4 border cursor-pointer transition-colors ${"pickup"===w?"border-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] hover:border-[#3a3a3a]"}`,children:[(0,a.jsx)("input",{type:"radio",name:"deliveryMethod",checked:"pickup"===w,onChange:()=>C("pickup"),className:"mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:"Pickup"}),(0,a.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:"Pick up from our Lagos studio - Free"})]})]})]}),"delivery"===w&&(0,a.jsxs)("div",{className:"space-y-4 border-t border-[#1a1a1a] pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"Delivery Address"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Street Address *"}),(0,a.jsx)("input",{type:"text",value:P.street,onChange:e=>A({...P,street:e.target.value}),className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-3 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"City *"}),(0,a.jsx)("input",{type:"text",value:P.city,onChange:e=>A({...P,city:e.target.value}),className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-3 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"State *"}),(0,a.jsx)("select",{value:P.state,onChange:e=>A({...P,state:e.target.value}),className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-3 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none",children:d.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Landmark (optional)"}),(0,a.jsx)("input",{type:"text",value:P.landmark,onChange:e=>A({...P,landmark:e.target.value}),className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-3 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none",placeholder:"Near any landmark..."})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,a.jsx)("button",{onClick:()=>b(1),className:"flex-1 border border-[#2a2a2a] text-[#888888] py-3 text-sm font-[family-name:var(--font-montserrat)] hover:border-[#3a3a3a] hover:text-[#f5f5f5] transition-colors",children:"Back"}),(0,a.jsx)("button",{onClick:()=>T()&&b(3),disabled:!T(),className:"flex-1 bg-[#c9a962] text-[#0a0a0a] py-3 text-sm tracking-[0.1em] uppercase font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue to Payment"})]})]}),3===p&&(0,a.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-6",children:"Payment Method"}),(0,a.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,a.jsxs)("label",{className:`flex items-start gap-4 p-4 border cursor-pointer transition-colors ${"online"===S?"border-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] hover:border-[#3a3a3a]"}`,children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",checked:"online"===S,onChange:()=>$("online"),className:"mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:"Pay Online"}),(0,a.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:"Pay securely with card or bank transfer via Paystack"})]})]}),(0,a.jsxs)("label",{className:`flex items-start gap-4 p-4 border cursor-pointer transition-colors ${"pay-on-delivery"===S?"border-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] hover:border-[#3a3a3a]"}`,children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",checked:"pay-on-delivery"===S,onChange:()=>$("pay-on-delivery"),className:"mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:"Pay on Delivery"}),(0,a.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:"Pay cash or transfer when you receive your order"})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-[#1a1a1a] pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:"Order Summary"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm font-[family-name:var(--font-montserrat)]",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[#888888]",children:[(0,a.jsx)("span",{children:"Contact:"}),(0,a.jsx)("span",{className:"text-[#f5f5f5]",children:g.phone})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[#888888]",children:[(0,a.jsx)("span",{children:"Delivery:"}),(0,a.jsx)("span",{className:"text-[#f5f5f5]",children:"pickup"===w?"Pickup":`${P.city}, ${P.state}`})]})]})]}),(0,a.jsx)("div",{className:"border-t border-[#1a1a1a] pt-6 mt-6",children:(0,a.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:D,onChange:e=>E(e.target.checked),className:"mt-1 w-4 h-4 accent-[#c9a962]"}),(0,a.jsxs)("span",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:["I agree to the"," ",(0,a.jsx)(n.default,{href:"/terms",target:"_blank",className:"text-[#c9a962] hover:underline",children:"Terms & Conditions"})]})]})}),(0,a.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,a.jsx)("button",{onClick:()=>b(2),className:"flex-1 border border-[#2a2a2a] text-[#888888] py-3 text-sm font-[family-name:var(--font-montserrat)] hover:border-[#3a3a3a] hover:text-[#f5f5f5] transition-colors",children:"Back"}),(0,a.jsx)("button",{onClick:F,disabled:y||!D,className:"flex-1 bg-[#c9a962] text-[#0a0a0a] py-3 text-sm tracking-[0.1em] uppercase font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Processing...":"online"===S?"Pay Now":"Place Order"})]})]})]}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-6 sticky top-24",children:[(0,a.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-6",children:"Order Summary"}),(0,a.jsx)("div",{className:"space-y-4 mb-6",children:f.map(e=>(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"w-16 h-20 relative flex-shrink-0 bg-[#0a0a0a]",children:[(0,a.jsx)(s.default,{src:e.image,alt:e.productName,fill:!0,className:"object-cover"}),(0,a.jsx)("span",{className:"absolute -top-2 -right-2 bg-[#c9a962] text-[#0a0a0a] text-xs w-5 h-5 rounded-full flex items-center justify-center font-[family-name:var(--font-montserrat)]",children:e.quantity})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-sm font-[family-name:var(--font-cormorant)] text-[#f5f5f5] truncate",children:e.productName}),(0,a.jsxs)("p",{className:"text-xs text-[#888888] font-[family-name:var(--font-montserrat)]",children:["Size: ",e.size]}),(0,a.jsx)("p",{className:"text-sm text-[#c9a962] font-[family-name:var(--font-montserrat)] mt-1",children:m((e.salePrice||e.price)*e.quantity)})]})]},`${e.productId}-${e.size}`))}),(0,a.jsxs)("div",{className:"border-t border-[#1a1a1a] pt-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm font-[family-name:var(--font-montserrat)]",children:[(0,a.jsx)("span",{className:"text-[#888888]",children:"Subtotal"}),(0,a.jsx)("span",{className:"text-[#f5f5f5]",children:m(x)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm font-[family-name:var(--font-montserrat)]",children:[(0,a.jsx)("span",{className:"text-[#888888]",children:"Delivery"}),(0,a.jsx)("span",{className:"text-[#f5f5f5]",children:0===I?"Free":m(I)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-lg font-[family-name:var(--font-cormorant)] pt-2 border-t border-[#1a1a1a]",children:[(0,a.jsx)("span",{className:"text-[#f5f5f5]",children:"Total"}),(0,a.jsx)("span",{className:"text-[#c9a962]",children:m(O)})]})]}),j?.freeAbove&&x<j.freeAbove&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-[#c9a962]/10 border border-[#c9a962]/30",children:(0,a.jsxs)("p",{className:"text-[#c9a962] text-xs font-[family-name:var(--font-montserrat)]",children:["Add ",m(j.freeAbove-x)," more for free delivery!"]})})]})})]})]})})}e.s(["default",()=>f])}]);