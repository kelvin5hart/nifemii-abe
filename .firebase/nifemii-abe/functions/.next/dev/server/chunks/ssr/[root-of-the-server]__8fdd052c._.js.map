{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/kelvinatemie-hart/Documents/Website/nifemii-abe/src/contexts/CartContext.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n  ReactNode,\n} from \"react\";\nimport { Product } from \"@/lib/firebase-types\";\n\nexport interface CartItem {\n  productId: string;\n  productName: string;\n  price: number;\n  salePrice?: number;\n  image: string;\n  size: string;\n  quantity: number;\n}\n\ninterface CartContextType {\n  items: CartItem[];\n  itemCount: number;\n  subtotal: number;\n  addToCart: (product: Product, size: string, quantity?: number) => void;\n  removeFromCart: (productId: string, size: string) => void;\n  updateQuantity: (productId: string, size: string, quantity: number) => void;\n  clearCart: () => void;\n  isCartOpen: boolean;\n  setIsCartOpen: (open: boolean) => void;\n}\n\nconst CartContext = createContext<CartContextType | undefined>(undefined);\n\nconst CART_STORAGE_KEY = \"nifemii-cart\";\n\nexport function CartProvider({ children }: { children: ReactNode }) {\n  const [items, setItems] = useState<CartItem[]>([]);\n  const [isCartOpen, setIsCartOpen] = useState(false);\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  // Load cart from localStorage on mount\n  useEffect(() => {\n    const savedCart = localStorage.getItem(CART_STORAGE_KEY);\n    if (savedCart) {\n      try {\n        setItems(JSON.parse(savedCart));\n      } catch (e) {\n        console.error(\"Error loading cart:\", e);\n      }\n    }\n    setIsInitialized(true);\n  }, []);\n\n  // Save cart to localStorage whenever it changes\n  useEffect(() => {\n    if (isInitialized) {\n      localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(items));\n    }\n  }, [items, isInitialized]);\n\n  const itemCount = items.reduce((sum, item) => sum + item.quantity, 0);\n\n  const subtotal = items.reduce((sum, item) => {\n    const price = item.salePrice || item.price;\n    return sum + price * item.quantity;\n  }, 0);\n\n  const addToCart = (product: Product, size: string, quantity = 1) => {\n    setItems((currentItems) => {\n      const existingItemIndex = currentItems.findIndex(\n        (item) => item.productId === product.id && item.size === size\n      );\n\n      if (existingItemIndex > -1) {\n        // Update quantity of existing item\n        const updatedItems = [...currentItems];\n        updatedItems[existingItemIndex].quantity += quantity;\n        return updatedItems;\n      } else {\n        // Add new item\n        return [\n          ...currentItems,\n          {\n            productId: product.id,\n            productName: product.name,\n            price: product.price,\n            salePrice: product.salePrice,\n            image: product.images[0] || \"/images/placeholder.jpg\",\n            size,\n            quantity,\n          },\n        ];\n      }\n    });\n\n    // Open cart drawer when adding item\n    setIsCartOpen(true);\n  };\n\n  const removeFromCart = (productId: string, size: string) => {\n    setItems((currentItems) =>\n      currentItems.filter(\n        (item) => !(item.productId === productId && item.size === size)\n      )\n    );\n  };\n\n  const updateQuantity = (productId: string, size: string, quantity: number) => {\n    if (quantity <= 0) {\n      removeFromCart(productId, size);\n      return;\n    }\n\n    setItems((currentItems) =>\n      currentItems.map((item) =>\n        item.productId === productId && item.size === size\n          ? { ...item, quantity }\n          : item\n      )\n    );\n  };\n\n  const clearCart = () => {\n    setItems([]);\n  };\n\n  return (\n    <CartContext.Provider\n      value={{\n        items,\n        itemCount,\n        subtotal,\n        addToCart,\n        removeFromCart,\n        updateQuantity,\n        clearCart,\n        isCartOpen,\n        setIsCartOpen,\n      }}\n    >\n      {children}\n    </CartContext.Provider>\n  );\n}\n\nexport function useCart() {\n  const context = useContext(CartContext);\n  if (context === undefined) {\n    throw new Error(\"useCart must be used within a CartProvider\");\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAiCA,MAAM,4BAAc,IAAA,sNAAa,EAA8B;AAE/D,MAAM,mBAAmB;AAElB,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAa,EAAE;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IAEnD,uCAAuC;IACvC,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY,aAAa,OAAO,CAAC;QACvC,IAAI,WAAW;YACb,IAAI;gBACF,SAAS,KAAK,KAAK,CAAC;YACtB,EAAE,OAAO,GAAG;gBACV,QAAQ,KAAK,CAAC,uBAAuB;YACvC;QACF;QACA,iBAAiB;IACnB,GAAG,EAAE;IAEL,gDAAgD;IAChD,IAAA,kNAAS,EAAC;QACR,IAAI,eAAe;YACjB,aAAa,OAAO,CAAC,kBAAkB,KAAK,SAAS,CAAC;QACxD;IACF,GAAG;QAAC;QAAO;KAAc;IAEzB,MAAM,YAAY,MAAM,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,EAAE;IAEnE,MAAM,WAAW,MAAM,MAAM,CAAC,CAAC,KAAK;QAClC,MAAM,QAAQ,KAAK,SAAS,IAAI,KAAK,KAAK;QAC1C,OAAO,MAAM,QAAQ,KAAK,QAAQ;IACpC,GAAG;IAEH,MAAM,YAAY,CAAC,SAAkB,MAAc,WAAW,CAAC;QAC7D,SAAS,CAAC;YACR,MAAM,oBAAoB,aAAa,SAAS,CAC9C,CAAC,OAAS,KAAK,SAAS,KAAK,QAAQ,EAAE,IAAI,KAAK,IAAI,KAAK;YAG3D,IAAI,oBAAoB,CAAC,GAAG;gBAC1B,mCAAmC;gBACnC,MAAM,eAAe;uBAAI;iBAAa;gBACtC,YAAY,CAAC,kBAAkB,CAAC,QAAQ,IAAI;gBAC5C,OAAO;YACT,OAAO;gBACL,eAAe;gBACf,OAAO;uBACF;oBACH;wBACE,WAAW,QAAQ,EAAE;wBACrB,aAAa,QAAQ,IAAI;wBACzB,OAAO,QAAQ,KAAK;wBACpB,WAAW,QAAQ,SAAS;wBAC5B,OAAO,QAAQ,MAAM,CAAC,EAAE,IAAI;wBAC5B;wBACA;oBACF;iBACD;YACH;QACF;QAEA,oCAAoC;QACpC,cAAc;IAChB;IAEA,MAAM,iBAAiB,CAAC,WAAmB;QACzC,SAAS,CAAC,eACR,aAAa,MAAM,CACjB,CAAC,OAAS,CAAC,CAAC,KAAK,SAAS,KAAK,aAAa,KAAK,IAAI,KAAK,IAAI;IAGpE;IAEA,MAAM,iBAAiB,CAAC,WAAmB,MAAc;QACvD,IAAI,YAAY,GAAG;YACjB,eAAe,WAAW;YAC1B;QACF;QAEA,SAAS,CAAC,eACR,aAAa,GAAG,CAAC,CAAC,OAChB,KAAK,SAAS,KAAK,aAAa,KAAK,IAAI,KAAK,OAC1C;oBAAE,GAAG,IAAI;oBAAE;gBAAS,IACpB;IAGV;IAEA,MAAM,YAAY;QAChB,SAAS,EAAE;IACb;IAEA,qBACE,8OAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///Users/kelvinatemie-hart/Documents/Website/nifemii-abe/src/components/Navbar.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname } from \"next/navigation\";\nimport { useState, useEffect } from \"react\";\nimport { useCart } from \"@/contexts/CartContext\";\nimport CartDrawer from \"./CartDrawer\";\n\nexport default function Navbar() {\n  const [isScrolled, setIsScrolled] = useState(false);\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\n  const pathname = usePathname();\n  const { itemCount, setIsCartOpen } = useCart();\n\n  useEffect(() => {\n    const handleScroll = () => {\n      setIsScrolled(window.scrollY > 50);\n    };\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  const isActive = (href: string) => {\n    if (href === \"/\") {\n      return pathname === \"/\";\n    }\n    return pathname.startsWith(href);\n  };\n\n  const navLinks = [\n    { href: \"/\", label: \"Home\" },\n    { href: \"/shop\", label: \"Shop\" },\n    { href: \"/services\", label: \"Services\" },\n    { href: \"/about\", label: \"About\" },\n    { href: \"/contact\", label: \"Contact\" },\n  ];\n\n  return (\n    <nav\n      className={`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${\n        isScrolled\n          ? \"bg-[#0a0a0a]/95 backdrop-blur-sm py-4\"\n          : \"bg-transparent py-6\"\n      }`}\n    >\n      <div className=\"max-w-7xl mx-auto px-6 flex items-center justify-between\">\n        {/* Logo */}\n        <Link href=\"/\" className=\"group\">\n          <h1 className=\"text-2xl md:text-3xl font-light tracking-[0.2em] text-[#f5f5f5] font-[family-name:var(--font-cormorant)]\">\n            NIFEMII{\" \"}\n            <span className=\"text-[#c9a962] group-hover:text-[#e5d4a1] transition-colors\">\n              ABE\n            </span>\n          </h1>\n        </Link>\n\n        {/* Desktop Navigation */}\n        <div className=\"hidden md:flex items-center space-x-8\">\n          {navLinks.map((link) => (\n            <Link\n              key={link.href}\n              href={link.href}\n              className={`text-sm tracking-[0.15em] transition-colors duration-300 font-[family-name:var(--font-montserrat)] uppercase ${\n                isActive(link.href)\n                  ? \"text-[#c9a962] border-b border-[#c9a962] pb-1\"\n                  : \"text-[#888888] hover:text-[#c9a962]\"\n              }`}\n            >\n              {link.label}\n            </Link>\n          ))}\n          {/* Cart Button */}\n          <button\n            onClick={() => setIsCartOpen(true)}\n            className=\"relative text-[#888888] hover:text-[#c9a962] transition-colors\"\n            aria-label=\"Open cart\"\n          >\n            <svg\n              className=\"w-6 h-6\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={1.5}\n                d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\"\n              />\n            </svg>\n            {itemCount > 0 && (\n              <span className=\"absolute -top-2 -right-2 bg-[#c9a962] text-[#0a0a0a] text-xs w-5 h-5 rounded-full flex items-center justify-center font-[family-name:var(--font-montserrat)]\">\n                {itemCount}\n              </span>\n            )}\n          </button>\n        </div>\n\n        {/* Mobile Cart & Menu */}\n        <div className=\"md:hidden flex items-center gap-4\">\n          {/* Mobile Cart Button */}\n          <button\n            onClick={() => setIsCartOpen(true)}\n            className=\"relative text-[#888888] hover:text-[#c9a962] transition-colors\"\n            aria-label=\"Open cart\"\n          >\n            <svg\n              className=\"w-6 h-6\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={1.5}\n                d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\"\n              />\n            </svg>\n            {itemCount > 0 && (\n              <span className=\"absolute -top-2 -right-2 bg-[#c9a962] text-[#0a0a0a] text-xs w-5 h-5 rounded-full flex items-center justify-center font-[family-name:var(--font-montserrat)]\">\n                {itemCount}\n              </span>\n            )}\n          </button>\n\n          {/* Mobile Menu Button */}\n          <button\n            className=\"flex flex-col space-y-1.5 p-2\"\n            onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\n            aria-label=\"Toggle menu\"\n          >\n          <span\n            className={`w-6 h-0.5 bg-[#f5f5f5] transition-all duration-300 ${\n              isMobileMenuOpen ? \"rotate-45 translate-y-2\" : \"\"\n            }`}\n          />\n          <span\n            className={`w-6 h-0.5 bg-[#f5f5f5] transition-all duration-300 ${\n              isMobileMenuOpen ? \"opacity-0\" : \"\"\n            }`}\n          />\n          <span\n            className={`w-6 h-0.5 bg-[#f5f5f5] transition-all duration-300 ${\n              isMobileMenuOpen ? \"-rotate-45 -translate-y-2\" : \"\"\n            }`}\n          />\n          </button>\n        </div>\n      </div>\n\n      {/* Mobile Menu */}\n      <div\n        className={`md:hidden absolute top-full left-0 right-0 bg-[#0a0a0a]/98 backdrop-blur-sm transition-all duration-300 ${\n          isMobileMenuOpen\n            ? \"opacity-100 visible\"\n            : \"opacity-0 invisible\"\n        }`}\n      >\n        <div className=\"px-6 py-8 flex flex-col space-y-6\">\n          {navLinks.map((link) => (\n            <Link\n              key={link.href}\n              href={link.href}\n              className={`text-lg tracking-[0.15em] transition-colors duration-300 font-[family-name:var(--font-montserrat)] uppercase ${\n                isActive(link.href)\n                  ? \"text-[#c9a962]\"\n                  : \"text-[#888888] hover:text-[#c9a962]\"\n              }`}\n              onClick={() => setIsMobileMenuOpen(false)}\n            >\n              {link.label}\n            </Link>\n          ))}\n        </div>\n      </div>\n    </nav>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 502, "column": 0}, "map": {"version":3,"sources":["file:///Users/kelvinatemie-hart/Documents/Website/nifemii-abe/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps } from \"firebase/app\";\nimport { getAuth, connectAuthEmulator } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAmJ53W4OJp6xbJ-QHVAaBbJg4EQLdbIh4\",\n  authDomain: \"nifemii-abe-689cd.firebaseapp.com\",\n  projectId: \"nifemii-abe-689cd\",\n  storageBucket: \"nifemii-abe-689cd.firebasestorage.app\",\n  messagingSenderId: \"430817811311\",\n  appId: \"1:430817811311:web:33e9e78812dbc457f9a69a\",\n  measurementId: \"G-SFVS5YF9HY\",\n};\n\n// Initialize Firebase only if not already initialized\nconst app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];\n\nexport const auth = getAuth(app);\nexport const db = getFirestore(app);\n\n// Set language for phone auth\nif (typeof window !== \"undefined\") {\n  auth.languageCode = \"en\";\n}\n\nexport default app;\n"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;IACP,eAAe;AACjB;AAEA,sDAAsD;AACtD,MAAM,MAAM,IAAA,2KAAO,IAAG,MAAM,KAAK,IAAI,IAAA,iLAAa,EAAC,kBAAkB,IAAA,2KAAO,GAAE,CAAC,EAAE;AAE1E,MAAM,OAAO,IAAA,6KAAO,EAAC;AACrB,MAAM,KAAK,IAAA,iLAAY,EAAC;AAE/B,8BAA8B;AAC9B;;uCAIe"}},
    {"offset": {"line": 540, "column": 0}, "map": {"version":3,"sources":["file:///Users/kelvinatemie-hart/Documents/Website/nifemii-abe/src/lib/otp-service.ts"],"sourcesContent":["import {\n  doc,\n  setDoc,\n  getDoc,\n  deleteDoc,\n  serverTimestamp,\n  Timestamp,\n} from \"firebase/firestore\";\nimport { db } from \"./firebase\";\n\n// OTP expires after 5 minutes\nconst OTP_EXPIRY_MINUTES = 5;\n\n// Termii API configuration\nconst TERMII_API_KEY = \"TLezWGrsbuJBBCLYZiUogzZjzofxaIKYqRwsjvenTDZQxuBMfbGexCQoFvQWhM\";\n\ninterface OTPDocument {\n  phone: string;\n  code: string;\n  createdAt: Timestamp;\n  expiresAt: Timestamp;\n  attempts: number;\n}\n\n// Generate a 6-digit OTP\nexport function generateOTP(): string {\n  return Math.floor(100000 + Math.random() * 900000).toString();\n}\n\n// Format phone number to standard format\nexport function formatPhoneNumber(phone: string): string {\n  // Remove all non-digits\n  let digits = phone.replace(/\\D/g, \"\");\n\n  // Handle Nigerian numbers\n  if (digits.startsWith(\"0\")) {\n    digits = \"234\" + digits.slice(1);\n  } else if (!digits.startsWith(\"234\")) {\n    digits = \"234\" + digits;\n  }\n\n  return \"+\" + digits;\n}\n\n// Format phone for Termii (without + sign)\nfunction formatPhoneForTermii(phone: string): string {\n  return phone.replace(/\\+/g, \"\");\n}\n\n// Create OTP document ID from phone number (safe for Firestore)\nfunction getOTPDocId(phone: string): string {\n  return phone.replace(/\\+/g, \"\");\n}\n\n// Send SMS via Termii (disabled until Sender ID is approved)\n// To enable: Request a Sender ID on Termii dashboard, then update TERMII_SENDER_ID\nconst TERMII_SENDER_ID = \"\"; // Set your approved sender ID here\n\nasync function sendSMSViaTermii(phone: string, code: string): Promise<boolean> {\n  // Skip SMS if no sender ID configured\n  if (!TERMII_SENDER_ID) {\n    console.log(\"========================================\");\n    console.log(`ðŸ“± OTP CODE for ${phone}: ${code}`);\n    console.log(\"========================================\");\n    console.log(\"(SMS disabled - configure TERMII_SENDER_ID to enable)\");\n    return true; // Return true so the flow continues\n  }\n\n  try {\n    const response = await fetch(\"https://api.ng.termii.com/api/sms/send\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        api_key: TERMII_API_KEY,\n        to: formatPhoneForTermii(phone),\n        from: TERMII_SENDER_ID,\n        sms: `Your Nifemii Abe verification code is: ${code}. Valid for ${OTP_EXPIRY_MINUTES} minutes.`,\n        type: \"plain\",\n        channel: \"generic\",\n      }),\n    });\n\n    const data = await response.json();\n    console.log(\"Termii response:\", JSON.stringify(data, null, 2));\n\n    if (data.message_id || response.status === 200) {\n      return true;\n    } else {\n      console.error(\"Termii error:\", JSON.stringify(data, null, 2));\n      // Still log OTP to console as fallback\n      console.log(`ðŸ“± OTP CODE (SMS failed): ${code}`);\n      return true;\n    }\n  } catch (error) {\n    console.error(\"Error sending SMS via Termii:\", error);\n    console.log(`ðŸ“± OTP CODE (SMS error): ${code}`);\n    return true;\n  }\n}\n\n// Send OTP\nexport async function sendOTP(phone: string): Promise<{ success: boolean; message: string }> {\n  try {\n    const formattedPhone = formatPhoneNumber(phone);\n    const docId = getOTPDocId(formattedPhone);\n    const code = generateOTP();\n\n    const now = new Date();\n    const expiresAt = new Date(now.getTime() + OTP_EXPIRY_MINUTES * 60 * 1000);\n\n    // Store OTP in Firestore\n    await setDoc(doc(db, \"otps\", docId), {\n      phone: formattedPhone,\n      code: code,\n      createdAt: serverTimestamp(),\n      expiresAt: Timestamp.fromDate(expiresAt),\n      attempts: 0,\n    });\n\n    // Send SMS via Termii\n    const smsSent = await sendSMSViaTermii(formattedPhone, code);\n\n    if (!smsSent) {\n      // Log for debugging but don't fail - in case Termii has issues\n      console.warn(\"SMS sending may have failed, but OTP is stored\");\n    }\n\n    return {\n      success: true,\n      message: `Verification code sent to ${formattedPhone}`,\n    };\n  } catch (error) {\n    console.error(\"Error sending OTP:\", error);\n    return {\n      success: false,\n      message: \"Failed to send OTP. Please try again.\",\n    };\n  }\n}\n\n// Verify OTP\nexport async function verifyOTP(\n  phone: string,\n  code: string\n): Promise<{ success: boolean; message: string }> {\n  try {\n    const formattedPhone = formatPhoneNumber(phone);\n    const docId = getOTPDocId(formattedPhone);\n\n    const otpDoc = await getDoc(doc(db, \"otps\", docId));\n\n    if (!otpDoc.exists()) {\n      return {\n        success: false,\n        message: \"No OTP found. Please request a new code.\",\n      };\n    }\n\n    const otpData = otpDoc.data() as OTPDocument;\n\n    // Check if expired\n    const now = new Date();\n    const expiresAt = otpData.expiresAt.toDate();\n    if (now > expiresAt) {\n      await deleteDoc(doc(db, \"otps\", docId));\n      return {\n        success: false,\n        message: \"OTP has expired. Please request a new code.\",\n      };\n    }\n\n    // Check attempts (max 3)\n    if (otpData.attempts >= 3) {\n      await deleteDoc(doc(db, \"otps\", docId));\n      return {\n        success: false,\n        message: \"Too many attempts. Please request a new code.\",\n      };\n    }\n\n    // Verify code\n    if (otpData.code !== code) {\n      // Increment attempts\n      await setDoc(\n        doc(db, \"otps\", docId),\n        { attempts: otpData.attempts + 1 },\n        { merge: true }\n      );\n      return {\n        success: false,\n        message: `Invalid code. ${2 - otpData.attempts} attempts remaining.`,\n      };\n    }\n\n    // OTP verified - delete it\n    await deleteDoc(doc(db, \"otps\", docId));\n\n    return {\n      success: true,\n      message: \"OTP verified successfully.\",\n    };\n  } catch (error) {\n    console.error(\"Error verifying OTP:\", error);\n    return {\n      success: false,\n      message: \"Failed to verify OTP. Please try again.\",\n    };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 690, "column": 0}, "map": {"version":3,"sources":["file:///Users/kelvinatemie-hart/Documents/Website/nifemii-abe/src/contexts/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n  ReactNode,\n} from \"react\";\nimport {\n  User as FirebaseUser,\n  onAuthStateChanged,\n  signOut as firebaseSignOut,\n  signInWithEmailAndPassword,\n  signInAnonymously,\n} from \"firebase/auth\";\nimport {\n  doc,\n  getDoc,\n  setDoc,\n  serverTimestamp,\n  query,\n  collection,\n  where,\n  getDocs,\n} from \"firebase/firestore\";\nimport { auth, db } from \"@/lib/firebase\";\nimport { User } from \"@/lib/firebase-types\";\nimport {\n  sendOTP as sendOTPService,\n  verifyOTP as verifyOTPService,\n  formatPhoneNumber,\n} from \"@/lib/otp-service\";\n\ninterface AuthContextType {\n  firebaseUser: FirebaseUser | null;\n  user: User | null;\n  loading: boolean;\n  isAdmin: boolean;\n\n  // Phone auth (custom OTP)\n  sendOTP: (phoneNumber: string) => Promise<{ success: boolean; message: string }>;\n  verifyOTPAndSignIn: (phoneNumber: string, otp: string) => Promise<{ success: boolean; message: string }>;\n\n  // Admin auth\n  adminLogin: (email: string, password: string) => Promise<void>;\n\n  // Sign out\n  signOut: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [firebaseUser, setFirebaseUser] = useState<FirebaseUser | null>(null);\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  // Listen to auth state changes\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      setFirebaseUser(firebaseUser);\n\n      if (firebaseUser) {\n        // Fetch user data from Firestore\n        const userDoc = await getDoc(doc(db, \"users\", firebaseUser.uid));\n        if (userDoc.exists()) {\n          setUser({ id: userDoc.id, ...userDoc.data() } as User);\n        } else {\n          // User exists in Firebase Auth but not in Firestore\n          // This can happen with anonymous users before phone verification\n          setUser(null);\n        }\n      } else {\n        setUser(null);\n      }\n\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  // Send OTP using custom service\n  const sendOTP = async (phoneNumber: string) => {\n    return await sendOTPService(phoneNumber);\n  };\n\n  // Verify OTP and sign in\n  const verifyOTPAndSignIn = async (phoneNumber: string, otp: string) => {\n    // First verify the OTP\n    const verifyResult = await verifyOTPService(phoneNumber, otp);\n\n    if (!verifyResult.success) {\n      return verifyResult;\n    }\n\n    const formattedPhone = formatPhoneNumber(phoneNumber);\n\n    try {\n      // Check if a user with this phone number already exists\n      const usersQuery = query(\n        collection(db, \"users\"),\n        where(\"phone\", \"==\", formattedPhone)\n      );\n      const existingUsers = await getDocs(usersQuery);\n\n      let userId: string;\n\n      if (!existingUsers.empty) {\n        // User exists - use their ID\n        userId = existingUsers.docs[0].id;\n\n        // Sign in anonymously to get a session (we'll link to the user data)\n        const anonResult = await signInAnonymously(auth);\n\n        // If the anonymous user ID doesn't match, we need to handle this\n        // For simplicity, we'll just use the existing user data\n        if (anonResult.user.uid !== userId) {\n          // Update the user doc to link with this auth session\n          // Or create a session mapping\n        }\n\n        setUser({ id: userId, ...existingUsers.docs[0].data() } as User);\n      } else {\n        // New user - create account\n        const anonResult = await signInAnonymously(auth);\n        userId = anonResult.user.uid;\n\n        // Create user document\n        await setDoc(doc(db, \"users\", userId), {\n          phone: formattedPhone,\n          createdAt: serverTimestamp(),\n          createdBy: \"self\",\n        });\n\n        setUser({\n          id: userId,\n          phone: formattedPhone,\n          createdAt: new Date(),\n          createdBy: \"self\",\n        });\n      }\n\n      return {\n        success: true,\n        message: \"Logged in successfully!\",\n      };\n    } catch (error) {\n      console.error(\"Sign in error:\", error);\n      return {\n        success: false,\n        message: \"Failed to sign in. Please try again.\",\n      };\n    }\n  };\n\n  // Admin login with email/password\n  const adminLogin = async (email: string, password: string) => {\n    const result = await signInWithEmailAndPassword(auth, email, password);\n\n    // Check if user is admin\n    const userDoc = await getDoc(doc(db, \"users\", result.user.uid));\n    if (!userDoc.exists() || !userDoc.data()?.isAdmin) {\n      await firebaseSignOut(auth);\n      throw new Error(\"Unauthorized: Not an admin\");\n    }\n\n    setUser({ id: userDoc.id, ...userDoc.data() } as User);\n  };\n\n  // Sign out\n  const signOut = async () => {\n    await firebaseSignOut(auth);\n    setUser(null);\n    setFirebaseUser(null);\n  };\n\n  const value: AuthContextType = {\n    firebaseUser,\n    user,\n    loading,\n    isAdmin: user?.isAdmin || false,\n    sendOTP,\n    verifyOTPAndSignIn,\n    adminLogin,\n    signOut,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 851, "column": 0}, "map": {"version":3,"sources":["file:///Users/kelvinatemie-hart/Documents/Website/nifemii-abe/src/components/Providers.tsx"],"sourcesContent":["\"use client\";\n\nimport { ReactNode } from \"react\";\nimport { AuthProvider } from \"@/contexts/AuthContext\";\nimport { CartProvider } from \"@/contexts/CartContext\";\n\nexport default function Providers({ children }: { children: ReactNode }) {\n  return (\n    <AuthProvider>\n      <CartProvider>{children}</CartProvider>\n    </AuthProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAMe,SAAS,UAAU,EAAE,QAAQ,EAA2B;IACrE,qBACE,8OAAC,+IAAY;kBACX,cAAA,8OAAC,+IAAY;sBAAE;;;;;;;;;;;AAGrB"}}]
}