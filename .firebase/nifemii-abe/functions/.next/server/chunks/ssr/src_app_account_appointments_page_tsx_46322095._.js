module.exports=[61383,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(20237),f=a.i(11642);let g={pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50",confirmed:"bg-blue-500/20 text-blue-400 border-blue-500/50",completed:"bg-green-500/20 text-green-400 border-green-500/50",cancelled:"bg-red-500/20 text-red-400 border-red-500/50",rescheduled:"bg-purple-500/20 text-purple-400 border-purple-500/50"},h={consultation:"Consultation",fitting:"Fitting",pickup:"Pickup","fabric-dropoff":"Fabric Drop-off"},i={consultation:"Discuss your style ideas and get expert recommendations",fitting:"Try on your outfit and make any necessary adjustments",pickup:"Collect your completed order from the studio","fabric-dropoff":"Bring your fabric for a sew-only order"},j={workingDays:["monday","tuesday","wednesday","thursday","friday","saturday"],workingHours:{start:"10:00",end:"18:00"},slotDuration:30,blockedDates:[],blockedTimeSlots:[]};function k(){let{user:a}=(0,f.useAuth)(),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(j),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)("consultation"),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!a?.phone)return;let b=(0,d.query)((0,d.collection)(e.db,"appointments"),(0,d.where)("userPhone","==",a.phone),(0,d.orderBy)("date","desc")),c=(0,d.onSnapshot)(b,a=>{l(a.docs.map(a=>{let b=a.data();return{id:a.id,...b,createdAt:b.createdAt?.toDate()||new Date}})),p(!1)});return()=>c()},[a?.phone]),(0,c.useEffect)(()=>{let a=(0,d.onSnapshot)((0,d.doc)(e.db,"settings","main"),a=>{if(a.exists()){let b=a.data();b.availability&&n({...j,...b.availability,blockedTimeSlots:b.availability.blockedTimeSlots||[]})}});return()=>a()},[]);let[O,P]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a=(0,d.query)((0,d.collection)(e.db,"appointments"),(0,d.where)("status","in",["pending","confirmed","rescheduled"])),b=(0,d.onSnapshot)(a,a=>{P(a.docs.map(a=>({id:a.id,...a.data()})))});return()=>b()},[]);let Q=()=>{let a=[],[b,c]=m.workingHours.start.split(":").map(Number),[d,e]=m.workingHours.end.split(":").map(Number),f=m.slotDuration,g=60*b+c,h=60*d+e;for(;g<h;){let b=Math.floor(g/60),c=g%60;a.push(`${b.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`),g+=f}return a},R=(a,b)=>{let c=m.blockedTimeSlots||[],d=parseInt(b.replace(":",""));return c.some(b=>{if(b.date!==a)return!1;let c=parseInt(b.startTime.replace(":","")),e=parseInt(b.endTime.replace(":",""));return d>=c&&d<e})},S=(a,b,c)=>O.some(d=>(!c||d.id!==c)&&d.date===a&&d.timeSlot===b),T=(a,b,c)=>R(a,b)||S(a,b,c),U=(a,b)=>Q().filter(c=>!T(a,c,b)),V=a=>{let b=new Date(a).toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();return!(!m.workingDays.includes(b)||m.blockedDates.includes(a))},W=async()=>{if(a?.phone&&w&&y){t(!0);try{await (0,d.addDoc)((0,d.collection)(e.db,"appointments"),{userId:a.id,userPhone:a.phone,userName:a.name||null,type:u,date:w,timeSlot:y,status:"pending",notes:A||null,createdBy:"customer",createdAt:d.Timestamp.now()}),r(!1),v("consultation"),x(""),z(""),B("")}catch(a){console.error("Error booking appointment:",a)}finally{t(!1)}}},X=a=>new Date(a).toLocaleDateString("en-NG",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),Y=k.filter(a=>new Date(a.date)>=new Date&&!["cancelled","completed"].includes(a.status)),Z=k.filter(a=>new Date(a.date)<new Date||["cancelled","completed"].includes(a.status)),$=async()=>{if(C){N(!0);try{await (0,d.updateDoc)((0,d.doc)(e.db,"appointments",C.id),{status:"cancelled",updatedAt:d.Timestamp.now()}),F(!1),D(null)}catch(a){console.error("Error cancelling appointment:",a)}finally{N(!1)}}},_=async()=>{if(C&&I&&K){N(!0);try{await (0,d.updateDoc)((0,d.doc)(e.db,"appointments",C.id),{date:I,timeSlot:K,status:"pending",updatedAt:d.Timestamp.now()}),H(!1),D(null),J(""),L("")}catch(a){console.error("Error rescheduling appointment:",a)}finally{N(!1)}}},aa=new Date().toISOString().split("T")[0];return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"Appointments"}),(0,b.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:"Schedule and manage your appointments"})]}),(0,b.jsx)("button",{onClick:()=>r(!0),className:"bg-[#c9a962] text-[#0a0a0a] px-4 py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors",children:"Book Appointment"})]}),o?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)("div",{className:"text-[#888888]",children:"Loading appointments..."})}):0===k.length?(0,b.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-12 text-center",children:[(0,b.jsx)("svg",{className:"w-16 h-16 text-[#2a2a2a] mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,b.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)] mb-4",children:"No appointments scheduled"}),(0,b.jsx)("button",{onClick:()=>r(!0),className:"inline-block bg-[#c9a962] text-[#0a0a0a] px-6 py-2 font-[family-name:var(--font-montserrat)] text-sm uppercase tracking-wider hover:bg-[#d4b87a] transition-colors",children:"Book Your First Appointment"})]}):(0,b.jsxs)("div",{className:"space-y-8",children:[Y.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:["Upcoming (",Y.length,")"]}),(0,b.jsx)("div",{className:"space-y-4",children:Y.map(a=>(0,b.jsx)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsxs)("div",{className:"text-center bg-[#0a0a0a] p-3 border border-[#1a1a1a]",children:[(0,b.jsx)("p",{className:"text-2xl text-[#c9a962] font-[family-name:var(--font-cormorant)]",children:new Date(a.date).getDate()}),(0,b.jsx)("p",{className:"text-xs text-[#888888] font-[family-name:var(--font-montserrat)] uppercase",children:new Date(a.date).toLocaleDateString("en-US",{month:"short"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:h[a.type]}),(0,b.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[a.timeSlot," •"," ",new Date(a.date).toLocaleDateString("en-NG",{weekday:"long"})]}),a.notes&&(0,b.jsxs)("p",{className:"text-sm text-[#666666] mt-1 font-[family-name:var(--font-montserrat)]",children:["Note: ",a.notes]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:`px-3 py-1 text-xs border ${g[a.status]} font-[family-name:var(--font-montserrat)]`,children:a.status}),["pending","confirmed"].includes(a.status)&&(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>{D(a),J(a.date),L(a.timeSlot),H(!0)},className:"text-[#c9a962] text-sm font-[family-name:var(--font-montserrat)] hover:underline",children:"Reschedule"}),(0,b.jsx)("button",{onClick:()=>{D(a),F(!0)},className:"text-red-400 text-sm font-[family-name:var(--font-montserrat)] hover:underline",children:"Cancel"})]})]})]})},a.id))})]}),Z.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:"Past Appointments"}),(0,b.jsx)("div",{className:"bg-[#111111] border border-[#1a1a1a] divide-y divide-[#1a1a1a]",children:Z.map(a=>(0,b.jsx)("div",{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:h[a.type]}),(0,b.jsxs)("span",{className:"text-[#888888] text-sm ml-3 font-[family-name:var(--font-montserrat)]",children:[X(a.date)," at ",a.timeSlot]})]}),(0,b.jsx)("span",{className:`px-2 py-0.5 text-xs border ${g[a.status]} font-[family-name:var(--font-montserrat)]`,children:a.status})]})},a.id))})]})]}),q&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"sticky top-0 bg-[#111111] border-b border-[#1a1a1a] px-6 py-4 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"Book Appointment"}),(0,b.jsx)("button",{onClick:()=>r(!1),className:"text-[#888888] hover:text-[#f5f5f5]",children:"✕"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-[#888888] mb-3 font-[family-name:var(--font-montserrat)]",children:"What do you need?"}),(0,b.jsx)("div",{className:"space-y-2",children:Object.keys(h).map(a=>(0,b.jsxs)("button",{onClick:()=>v(a),className:`w-full text-left p-3 border transition-colors ${u===a?"border-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] hover:border-[#3a3a3a]"}`,children:[(0,b.jsx)("p",{className:`font-[family-name:var(--font-montserrat)] ${u===a?"text-[#c9a962]":"text-[#f5f5f5]"}`,children:h[a]}),(0,b.jsx)("p",{className:"text-xs text-[#888888] font-[family-name:var(--font-montserrat)] mt-1",children:i[a]})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select Date"}),(0,b.jsx)("input",{type:"date",value:w,onChange:a=>{x(a.target.value),z("")},min:aa,className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-2 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none"}),w&&!V(w)&&(0,b.jsx)("p",{className:"text-red-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"This date is not available. Please select another date."})]}),w&&V(w)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select Time"}),(0,b.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Q().map(a=>{let c=R(w,a),d=S(w,a),e=c||d;return(0,b.jsxs)("button",{onClick:()=>!e&&z(a),disabled:e,className:`py-2 text-sm border font-[family-name:var(--font-montserrat)] transition-colors ${e?"border-[#1a1a1a] text-[#444444] bg-[#1a1a1a] cursor-not-allowed":y===a?"border-[#c9a962] text-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] text-[#888888] hover:border-[#3a3a3a]"}`,children:[a,d&&!c&&(0,b.jsx)("span",{className:"block text-[9px]",children:"Booked"}),c&&(0,b.jsx)("span",{className:"block text-[9px]",children:"Unavailable"})]},a)})}),0===U(w).length&&(0,b.jsx)("p",{className:"text-orange-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"No available time slots on this date. Please select another date."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Additional Notes (optional)"}),(0,b.jsx)("textarea",{value:A,onChange:a=>B(a.target.value),rows:2,className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-2 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none resize-none",placeholder:"Any special requests or notes..."})]}),w&&y&&(0,b.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,b.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"Your Appointment"}),(0,b.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:h[u]}),(0,b.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[X(w)," at ",y]})]}),(0,b.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,b.jsx)("button",{onClick:()=>r(!1),className:"flex-1 border border-[#2a2a2a] text-[#888888] py-2 font-[family-name:var(--font-montserrat)] hover:border-[#3a3a3a] hover:text-[#f5f5f5] transition-colors",children:"Cancel"}),(0,b.jsx)("button",{onClick:W,disabled:s||!w||!y||!V(w)||T(w,y),className:"flex-1 bg-[#c9a962] text-[#0a0a0a] py-2 font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50",children:s?"Booking...":"Confirm Booking"})]})]})]})}),E&&C&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-sm p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:"Cancel Appointment"}),(0,b.jsxs)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)] mb-2",children:["Are you sure you want to cancel your"," ",(0,b.jsx)("span",{className:"text-[#f5f5f5]",children:h[C.type]})," ","appointment?"]}),(0,b.jsxs)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)] mb-6",children:["Scheduled for"," ",(0,b.jsxs)("span",{className:"text-[#f5f5f5]",children:[X(C.date)," at ",C.timeSlot]})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>{F(!1),D(null)},disabled:M,className:"flex-1 border border-[#2a2a2a] text-[#f5f5f5] py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-[#1a1a1a] transition-colors disabled:opacity-50",children:"Keep Appointment"}),(0,b.jsx)("button",{onClick:$,disabled:M,className:"flex-1 bg-red-500 text-white py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-red-600 transition-colors disabled:opacity-50",children:M?"Cancelling...":"Yes, Cancel"})]})]})}),G&&C&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"sticky top-0 bg-[#111111] border-b border-[#1a1a1a] px-6 py-4 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"Reschedule Appointment"}),(0,b.jsx)("button",{onClick:()=>{H(!1),D(null),J(""),L("")},className:"text-[#888888] hover:text-[#f5f5f5]",children:"✕"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,b.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"Current Appointment"}),(0,b.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:h[C.type]}),(0,b.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[X(C.date)," at ",C.timeSlot]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select New Date"}),(0,b.jsx)("input",{type:"date",value:I,onChange:a=>{J(a.target.value),L("")},min:aa,className:"w-full bg-[#0a0a0a] border border-[#2a2a2a] px-4 py-2 text-[#f5f5f5] font-[family-name:var(--font-montserrat)] focus:border-[#c9a962] focus:outline-none"}),I&&!V(I)&&(0,b.jsx)("p",{className:"text-red-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"This date is not available. Please select another date."})]}),I&&V(I)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-[#888888] mb-2 font-[family-name:var(--font-montserrat)]",children:"Select New Time"}),(0,b.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Q().map(a=>{let c=R(I,a),d=S(I,a,C?.id),e=c||d;return(0,b.jsxs)("button",{onClick:()=>!e&&L(a),disabled:e,className:`py-2 text-sm border font-[family-name:var(--font-montserrat)] transition-colors relative ${e?"border-[#1a1a1a] text-[#444444] bg-[#1a1a1a] cursor-not-allowed":K===a?"border-[#c9a962] text-[#c9a962] bg-[#c9a962]/10":"border-[#2a2a2a] text-[#888888] hover:border-[#3a3a3a]"}`,children:[(0,b.jsx)("span",{className:e?"line-through":"",children:a}),d&&!c&&(0,b.jsx)("span",{className:"absolute -top-1 -right-1 text-[8px] bg-orange-500/80 text-white px-1 rounded",children:"Booked"}),c&&(0,b.jsx)("span",{className:"absolute -top-1 -right-1 text-[8px] bg-red-500/80 text-white px-1 rounded",children:"Unavailable"})]},a)})}),0===U(I,C?.id).length&&(0,b.jsx)("p",{className:"text-orange-400 text-xs mt-2 font-[family-name:var(--font-montserrat)]",children:"No available time slots on this date. Please select another date."})]}),I&&K&&(0,b.jsxs)("div",{className:"bg-[#c9a962]/10 p-4 border border-[#c9a962]/30",children:[(0,b.jsx)("p",{className:"text-xs text-[#c9a962] mb-2 font-[family-name:var(--font-montserrat)]",children:"New Appointment"}),(0,b.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:h[C.type]}),(0,b.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[X(I)," at ",K]})]}),(0,b.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,b.jsx)("button",{onClick:()=>{H(!1),D(null),J(""),L("")},disabled:M,className:"flex-1 border border-[#2a2a2a] text-[#888888] py-2 font-[family-name:var(--font-montserrat)] hover:border-[#3a3a3a] hover:text-[#f5f5f5] transition-colors disabled:opacity-50",children:"Cancel"}),(0,b.jsx)("button",{onClick:_,disabled:M||!I||!K||!V(I)||T(I,K,C?.id)||I===C.date&&K===C.timeSlot,className:"flex-1 bg-[#c9a962] text-[#0a0a0a] py-2 font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50",children:M?"Rescheduling...":"Confirm Reschedule"})]})]})]})})]})})}a.s(["default",()=>k])}];

//# sourceMappingURL=src_app_account_appointments_page_tsx_46322095._.js.map