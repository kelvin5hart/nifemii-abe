module.exports=[25950,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);a.i(69387);var f=a.i(60574),g=a.i(20237);function h(){let a=(0,d.useSearchParams)(),h=(0,d.useRouter)(),[i,j]=(0,c.useState)("loading"),[k,l]=(0,c.useState)(""),m=a.get("reference"),n=a.get("trxref"),o=m||n;return(0,c.useEffect)(()=>{(async()=>{if(!o){j("failed"),l("No payment reference found");return}try{let a=await fetch(`/api/paystack/verify?reference=${o}`),b=await a.json();if(!a.ok)throw Error(b.error||"Verification failed");if("success"===b.status){let a=b.metadata?.orderId,c=b.metadata?.paymentType||"full",d=b.amount/100;if(a)try{let b=await (0,f.getDoc)((0,f.doc)(g.db,"orders",a));if(b.exists()){let e=b.data(),h={updatedAt:f.Timestamp.now()};"deposit"===c?(h["pricing.depositPaid"]=!0,h["pricing.depositMethod"]="paystack",h["pricing.depositDate"]=f.Timestamp.now(),h["pricing.depositPaymentRef"]=o,"pending"===e.status&&(h.status="confirmed")):"balance"===c?(h["pricing.balancePaid"]=!0,h["pricing.balanceMethod"]="paystack",h["pricing.balanceDate"]=f.Timestamp.now(),h["pricing.balancePaymentRef"]=o):(h["pricing.depositPaid"]=!0,h["pricing.depositAmount"]=d,h["pricing.depositMethod"]="paystack",h["pricing.depositDate"]=f.Timestamp.now(),h["pricing.depositPaymentRef"]=o,h["pricing.balanceAmount"]=0,h["pricing.balancePaid"]=!0,"pending"===e.status&&(h.status="confirmed")),await (0,f.updateDoc)((0,f.doc)(g.db,"orders",a),h)}}catch(a){console.warn("Order update failed (webhook may have handled it):",a)}j("success"),setTimeout(()=>{h.push("/account/orders")},2e3)}else j("failed"),l("Payment was not successful")}catch(a){console.error("Verification error:",a),j("failed"),l(a instanceof Error?a.message:"Failed to verify payment")}})()},[o,h]),(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsx)("div",{className:"max-w-md w-full",children:(0,b.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-8 text-center",children:["loading"===i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-[#c9a962] border-t-transparent rounded-full animate-spin mx-auto mb-6"}),(0,b.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-2",children:"Verifying Payment"}),(0,b.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)]",children:"Please wait while we confirm your payment..."})]}),"success"===i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,b.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-2",children:"Payment Successful!"}),(0,b.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)]",children:"Redirecting you back to your orders..."})]}),"failed"===i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,b.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-2",children:"Payment Verification Failed"}),(0,b.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)] mb-6",children:k}),(0,b.jsx)(e.default,{href:"/account/orders",className:"block w-full bg-[#c9a962] text-[#0a0a0a] py-3 text-sm tracking-[0.1em] uppercase font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors",children:"Back to Orders"})]})]})})})}function i(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-[#c9a962] border-t-transparent rounded-full animate-spin"})}),children:(0,b.jsx)(h,{})})}a.s(["default",()=>i])}];

//# sourceMappingURL=src_app_account_orders_verify_page_tsx_4f204f6a._.js.map