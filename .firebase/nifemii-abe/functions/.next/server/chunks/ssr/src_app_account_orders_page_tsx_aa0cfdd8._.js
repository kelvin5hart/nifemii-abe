module.exports=[25786,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(20237),f=a.i(11642),g=a.i(38246);let h={pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50",confirmed:"bg-blue-500/20 text-blue-400 border-blue-500/50","in-progress":"bg-purple-500/20 text-purple-400 border-purple-500/50",ready:"bg-green-500/20 text-green-400 border-green-500/50",delivered:"bg-emerald-500/20 text-emerald-400 border-emerald-500/50",cancelled:"bg-red-500/20 text-red-400 border-red-500/50"},i={pending:"Pending Confirmation",confirmed:"Confirmed","in-progress":"In Progress",ready:"Ready for Pickup/Delivery",delivered:"Delivered",cancelled:"Cancelled"},j={"ready-to-wear":"Ready to Wear","full-bespoke":"Full Bespoke","sew-only":"Sew Only","bulk-bespoke":"Bulk Order"};function k(){let{user:a}=(0,f.useAuth)(),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!a?.phone)return;let b=(0,d.query)((0,d.collection)(e.db,"orders"),(0,d.where)("userPhone","==",a.phone),(0,d.orderBy)("createdAt","desc")),c=(0,d.onSnapshot)(b,a=>{l(a.docs.map(a=>{let b=a.data();return{id:a.id,...b,createdAt:b.createdAt?.toDate()||new Date,updatedAt:b.updatedAt?.toDate()||new Date}})),n(!1)});return()=>c()},[a?.phone]);let y=a=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(a),z=a=>new Intl.DateTimeFormat("en-NG",{day:"numeric",month:"short",year:"numeric"}).format(a),A=k.filter(a=>!["delivered","cancelled"].includes(a.status)),B=k.filter(a=>["delivered","cancelled"].includes(a.status)),C=async()=>{if(o){t(!0);try{await (0,d.updateDoc)((0,d.doc)(e.db,"orders",o.id),{status:"cancelled",updatedAt:d.Timestamp.now()}),p({...o,status:"cancelled"}),r(!1)}catch(a){console.error("Error cancelling order:",a)}finally{t(!1)}}},D=a=>{let b=a.pricing;if(void 0!==b.depositAmount){if(!b.depositPaid)return{type:"deposit",amount:b.depositAmount};if(!b.balancePaid&&b.balanceAmount&&b.balanceAmount>0)return{type:"balance",amount:b.balanceAmount}}else if("online"===a.paymentMethod&&!b.depositPaid)return{type:"full",amount:b.totalAmount};return null},E=async()=>{if(!o||!a)return;let b=D(o);if(b){x(!0);try{let c=await fetch("/api/paystack/initialize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.email||`${a.phone}@customer.nifemiiabe.com`,amount:b.amount,orderId:o.id,paymentType:b.type,callbackUrl:`${window.location.origin}/account/orders/verify`,metadata:{customerName:a.name||o.userName,customerPhone:a.phone}})}),d=await c.json();if(!c.ok)throw Error(d.error||"Failed to initialize payment");window.location.href=d.authorization_url}catch(a){console.error("Payment initialization error:",a),alert("Failed to initialize payment. Please try again.")}finally{x(!1)}}};return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"My Orders"}),(0,b.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:"Track your orders and view order history"})]}),m?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)("div",{className:"text-[#888888]",children:"Loading orders..."})}):0===k.length?(0,b.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-12 text-center",children:[(0,b.jsx)("svg",{className:"w-16 h-16 text-[#2a2a2a] mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),(0,b.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)] mb-4",children:"You haven't placed any orders yet"}),(0,b.jsx)(g.default,{href:"/shop",className:"inline-block bg-[#c9a962] text-[#0a0a0a] px-6 py-2 font-[family-name:var(--font-montserrat)] text-sm uppercase tracking-wider hover:bg-[#d4b87a] transition-colors",children:"Browse Shop"})]}):(0,b.jsxs)("div",{className:"space-y-8",children:[A.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:["Active Orders (",A.length,")"]}),(0,b.jsx)("div",{className:"space-y-4",children:A.map(a=>(0,b.jsxs)("div",{onClick:()=>p(a),className:"bg-[#111111] border border-[#1a1a1a] p-4 hover:border-[#c9a962]/50 transition-colors cursor-pointer",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsxs)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:["Order #",a.id.slice(0,8)]}),(0,b.jsx)("span",{className:`px-2 py-0.5 text-xs border ${h[a.status]} font-[family-name:var(--font-montserrat)]`,children:a.status})]}),(0,b.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[j[a.type]," • Placed ",z(a.createdAt)]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-[#c9a962] font-[family-name:var(--font-montserrat)]",children:y(a.pricing.totalAmount)}),(0,b.jsx)("p",{className:"text-xs text-[#888888] font-[family-name:var(--font-montserrat)]",children:"pickup"===a.deliveryMethod?"Pickup":"Delivery"})]})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)("div",{className:"flex items-center gap-2",children:["pending","confirmed","in-progress","ready","delivered"].map((c,d)=>{let e=["pending","confirmed","in-progress","ready","delivered"].indexOf(a.status),f=c===a.status;return(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:`h-1 ${d<=e?"bg-[#c9a962]":"bg-[#2a2a2a]"}`}),f&&(0,b.jsx)("p",{className:"text-[10px] text-[#c9a962] mt-1 font-[family-name:var(--font-montserrat)] capitalize",children:c.replace("-"," ")})]},c)})})})]},a.id))})]}),B.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:["Order History (",B.length,")"]}),(0,b.jsx)("div",{className:"bg-[#111111] border border-[#1a1a1a] divide-y divide-[#1a1a1a]",children:B.map(a=>(0,b.jsx)("div",{onClick:()=>p(a),className:"p-4 hover:bg-[#1a1a1a]/50 transition-colors cursor-pointer",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:["#",a.id.slice(0,8)]}),(0,b.jsx)("span",{className:"text-[#888888] text-sm ml-3 font-[family-name:var(--font-montserrat)]",children:j[a.type]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("span",{className:`px-2 py-0.5 text-xs border ${h[a.status]} font-[family-name:var(--font-montserrat)]`,children:a.status}),(0,b.jsx)("span",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:z(a.createdAt)}),(0,b.jsx)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:y(a.pricing.totalAmount)})]})]})},a.id))})]})]}),o&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"sticky top-0 bg-[#111111] border-b border-[#1a1a1a] px-6 py-4 flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:["Order #",o.id.slice(0,8)]}),(0,b.jsx)("button",{onClick:()=>p(null),className:"text-[#888888] hover:text-[#f5f5f5]",children:"✕"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("span",{className:`inline-block px-4 py-2 text-sm border ${h[o.status]} font-[family-name:var(--font-montserrat)]`,children:i[o.status]})}),(0,b.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,b.jsx)("p",{className:"text-xs text-[#666666] mb-1 font-[family-name:var(--font-montserrat)]",children:"Order Type"}),(0,b.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:j[o.type]})]}),o.items&&o.items.length>0&&(0,b.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,b.jsxs)("p",{className:"text-xs text-[#666666] mb-3 font-[family-name:var(--font-montserrat)]",children:["Items (",o.items.reduce((a,b)=>a+b.quantity,0)," total)"]}),(0,b.jsx)("div",{className:"space-y-4",children:o.items.map((a,c)=>(0,b.jsxs)("div",{className:"flex gap-4 pb-4 border-b border-[#1a1a1a] last:border-b-0 last:pb-0",children:[a.image?(0,b.jsxs)("button",{onClick:()=>v(a.image||null),className:"w-20 h-20 flex-shrink-0 bg-[#111111] border border-[#1a1a1a] overflow-hidden hover:border-[#c9a962] transition-colors group relative",children:[(0,b.jsx)("img",{src:a.image,alt:a.productName,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}):(0,b.jsx)("div",{className:"w-20 h-20 flex-shrink-0 bg-[#111111] border border-[#1a1a1a] flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-[#2a2a2a]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)] text-sm",children:a.productName}),a.sku&&(0,b.jsx)("span",{className:"text-[10px] text-[#c9a962] bg-[#c9a962]/10 px-2 py-0.5 font-[family-name:var(--font-montserrat)] whitespace-nowrap",children:a.sku})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-x-3 gap-y-1 mt-2 text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[a.size&&(0,b.jsxs)("span",{children:["Size: ",(0,b.jsx)("span",{className:"text-[#f5f5f5]",children:a.size})]}),(0,b.jsxs)("span",{children:["Qty: ",(0,b.jsx)("span",{className:"text-[#f5f5f5]",children:a.quantity})]})]}),(0,b.jsx)("p",{className:"text-[#c9a962] text-sm mt-2 font-[family-name:var(--font-montserrat)] font-medium",children:y(a.price*a.quantity)})]})]},c))})]}),o.serviceDetails&&(0,b.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,b.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"Service Details"}),o.serviceDetails.styleDescription&&(0,b.jsx)("p",{className:"text-[#f5f5f5] text-sm mb-2 font-[family-name:var(--font-montserrat)]",children:o.serviceDetails.styleDescription}),(0,b.jsxs)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:["Fabric:"," ",o.serviceDetails.fabricProvided?"Provided by you":"Studio fabric"]})]}),(0,b.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,b.jsx)("p",{className:"text-xs text-[#666666] mb-3 font-[family-name:var(--font-montserrat)]",children:"Payment Summary"}),(0,b.jsxs)("div",{className:"space-y-2 text-sm font-[family-name:var(--font-montserrat)]",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-[#888888]",children:"Subtotal"}),(0,b.jsx)("span",{className:"text-[#f5f5f5]",children:y(o.pricing.subtotal)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-[#888888]",children:"Delivery"}),(0,b.jsx)("span",{className:"text-[#f5f5f5]",children:o.pricing.deliveryFee>0?y(o.pricing.deliveryFee):"Free"})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-2 border-t border-[#1a1a1a]",children:[(0,b.jsx)("span",{className:"text-[#f5f5f5] font-medium",children:"Total"}),(0,b.jsx)("span",{className:"text-[#c9a962]",children:y(o.pricing.totalAmount)})]}),o.pricing.depositAmount&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs pt-2",children:[(0,b.jsx)("span",{className:"text-[#888888]",children:"Deposit"}),(0,b.jsxs)("span",{className:o.pricing.depositPaid?"text-green-400":"text-yellow-400",children:[y(o.pricing.depositAmount)," ",o.pricing.depositPaid?"(Paid)":"(Pending)"]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-[#888888]",children:"Balance"}),(0,b.jsxs)("span",{className:o.pricing.balancePaid?"text-green-400":"text-yellow-400",children:[y(o.pricing.balanceAmount||0)," ",o.pricing.balancePaid?"(Paid)":"(Pending)"]})]})]})]}),"cancelled"!==o.status&&"delivered"!==o.status&&D(o)&&(0,b.jsx)("button",{onClick:E,disabled:w,className:"w-full mt-4 bg-[#c9a962] text-[#0a0a0a] py-3 text-sm tracking-[0.1em] uppercase font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50",children:w?"Processing...":(0,b.jsxs)(b.Fragment,{children:["Pay ",D(o)?.type==="deposit"?"Deposit":D(o)?.type==="balance"?"Balance":""," Now - ",y(D(o)?.amount||0)]})})]}),(0,b.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,b.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"pickup"===o.deliveryMethod?"Pickup Location":"Delivery Address"}),"pickup"===o.deliveryMethod?(0,b.jsx)("p",{className:"text-[#f5f5f5] text-sm font-[family-name:var(--font-montserrat)]",children:"Nifemii Abe Studio"}):o.deliveryAddress&&(0,b.jsxs)("p",{className:"text-[#f5f5f5] text-sm font-[family-name:var(--font-montserrat)]",children:[o.deliveryAddress.street,","," ",o.deliveryAddress.city,","," ",o.deliveryAddress.state]})]}),(0,b.jsxs)("div",{className:"text-center text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:["Order placed on ",z(o.createdAt)]}),"pending"===o.status&&!q&&(0,b.jsxs)("div",{className:"pt-4 border-t border-[#1a1a1a]",children:[(0,b.jsx)("button",{onClick:()=>r(!0),className:"w-full border border-red-500/50 text-red-400 py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-red-500/10 transition-colors",children:"Cancel Order"}),(0,b.jsx)("p",{className:"text-xs text-[#666666] text-center mt-2 font-[family-name:var(--font-montserrat)]",children:"You can only cancel orders that haven't been confirmed yet"})]}),q&&(0,b.jsxs)("div",{className:"pt-4 border-t border-[#1a1a1a] bg-red-500/10 -mx-6 -mb-6 p-6",children:[(0,b.jsx)("p",{className:"text-red-400 text-sm font-[family-name:var(--font-montserrat)] mb-4 text-center",children:"Are you sure you want to cancel this order? This action cannot be undone."}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>r(!1),disabled:s,className:"flex-1 border border-[#2a2a2a] text-[#f5f5f5] py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-[#1a1a1a] transition-colors disabled:opacity-50",children:"Keep Order"}),(0,b.jsx)("button",{onClick:C,disabled:s,className:"flex-1 bg-red-500 text-white py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-red-600 transition-colors disabled:opacity-50",children:s?"Cancelling...":"Yes, Cancel"})]})]})]})]})}),u&&(0,b.jsxs)("div",{className:"fixed inset-0 bg-black/90 z-[60] flex items-center justify-center p-4",onClick:()=>v(null),children:[(0,b.jsx)("button",{onClick:()=>v(null),className:"absolute top-4 right-4 text-white/80 hover:text-white transition-colors",children:(0,b.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,b.jsx)("img",{src:u,alt:"Product",className:"max-w-full max-h-[85vh] object-contain",onClick:a=>a.stopPropagation()})]})]})}a.s(["default",()=>k])}];

//# sourceMappingURL=src_app_account_orders_page_tsx_aa0cfdd8._.js.map