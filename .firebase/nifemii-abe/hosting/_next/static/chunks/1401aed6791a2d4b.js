(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40901,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(36180);var s=e.i(98925),r=e.i(59141),n=e.i(57951),i=e.i(22016);let l={pending:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50",confirmed:"bg-blue-500/20 text-blue-400 border-blue-500/50","in-progress":"bg-purple-500/20 text-purple-400 border-purple-500/50",ready:"bg-green-500/20 text-green-400 border-green-500/50",delivered:"bg-emerald-500/20 text-emerald-400 border-emerald-500/50",cancelled:"bg-red-500/20 text-red-400 border-red-500/50"},o={pending:"Pending Confirmation",confirmed:"Confirmed","in-progress":"In Progress",ready:"Ready for Pickup/Delivery",delivered:"Delivered",cancelled:"Cancelled"},c={"ready-to-wear":"Ready to Wear","full-bespoke":"Full Bespoke","sew-only":"Sew Only","bulk-bespoke":"Bulk Order"};function d(){let{user:e}=(0,n.useAuth)(),[d,m]=(0,a.useState)([]),[x,f]=(0,a.useState)(!0),[p,h]=(0,a.useState)(null),[u,b]=(0,a.useState)(!1),[y,v]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),[g,w]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!e?.phone)return;let t=(0,s.query)((0,s.collection)(r.db,"orders"),(0,s.where)("userPhone","==",e.phone),(0,s.orderBy)("createdAt","desc")),a=(0,s.onSnapshot)(t,e=>{m(e.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()||new Date}})),f(!1)});return()=>a()},[e?.phone]);let k=e=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(e),A=e=>new Intl.DateTimeFormat("en-NG",{day:"numeric",month:"short",year:"numeric"}).format(e),P=d.filter(e=>!["delivered","cancelled"].includes(e.status)),C=d.filter(e=>["delivered","cancelled"].includes(e.status)),D=async()=>{if(p){v(!0);try{await (0,s.updateDoc)((0,s.doc)(r.db,"orders",p.id),{status:"cancelled",updatedAt:s.Timestamp.now()}),h({...p,status:"cancelled"}),b(!1)}catch(e){console.error("Error cancelling order:",e)}finally{v(!1)}}},S=e=>{let t=e.pricing;if(void 0!==t.depositAmount){if(!t.depositPaid)return{type:"deposit",amount:t.depositAmount};if(!t.balancePaid&&t.balanceAmount&&t.balanceAmount>0)return{type:"balance",amount:t.balanceAmount}}else if("online"===e.paymentMethod&&!t.depositPaid)return{type:"full",amount:t.totalAmount};return null},O=async()=>{if(!p||!e)return;let t=S(p);if(t){w(!0);try{let a=await fetch("/api/paystack/initialize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email||`${e.phone}@customer.nifemiiabe.com`,amount:t.amount,orderId:p.id,paymentType:t.type,callbackUrl:`${window.location.origin}/account/orders/verify`,metadata:{customerName:e.name||p.userName,customerPhone:e.phone}})}),s=await a.json();if(!a.ok)throw Error(s.error||"Failed to initialize payment");window.location.href=s.authorization_url}catch(e){console.error("Payment initialization error:",e),alert("Failed to initialize payment. Please try again.")}finally{w(!1)}}};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:"My Orders"}),(0,t.jsx)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:"Track your orders and view order history"})]}),x?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"text-[#888888]",children:"Loading orders..."})}):0===d.length?(0,t.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-12 text-center",children:[(0,t.jsx)("svg",{className:"w-16 h-16 text-[#2a2a2a] mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),(0,t.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)] mb-4",children:"You haven't placed any orders yet"}),(0,t.jsx)(i.default,{href:"/shop",className:"inline-block bg-[#c9a962] text-[#0a0a0a] px-6 py-2 font-[family-name:var(--font-montserrat)] text-sm uppercase tracking-wider hover:bg-[#d4b87a] transition-colors",children:"Browse Shop"})]}):(0,t.jsxs)("div",{className:"space-y-8",children:[P.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:["Active Orders (",P.length,")"]}),(0,t.jsx)("div",{className:"space-y-4",children:P.map(e=>(0,t.jsxs)("div",{onClick:()=>h(e),className:"bg-[#111111] border border-[#1a1a1a] p-4 hover:border-[#c9a962]/50 transition-colors cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsxs)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:["Order #",e.id.slice(0,8)]}),(0,t.jsx)("span",{className:`px-2 py-0.5 text-xs border ${l[e.status]} font-[family-name:var(--font-montserrat)]`,children:e.status})]}),(0,t.jsxs)("p",{className:"text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[c[e.type]," • Placed ",A(e.createdAt)]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-[#c9a962] font-[family-name:var(--font-montserrat)]",children:k(e.pricing.totalAmount)}),(0,t.jsx)("p",{className:"text-xs text-[#888888] font-[family-name:var(--font-montserrat)]",children:"pickup"===e.deliveryMethod?"Pickup":"Delivery"})]})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:["pending","confirmed","in-progress","ready","delivered"].map((a,s)=>{let r=["pending","confirmed","in-progress","ready","delivered"].indexOf(e.status),n=a===e.status;return(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:`h-1 ${s<=r?"bg-[#c9a962]":"bg-[#2a2a2a]"}`}),n&&(0,t.jsx)("p",{className:"text-[10px] text-[#c9a962] mt-1 font-[family-name:var(--font-montserrat)] capitalize",children:a.replace("-"," ")})]},a)})})})]},e.id))})]}),C.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-lg font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-4",children:["Order History (",C.length,")"]}),(0,t.jsx)("div",{className:"bg-[#111111] border border-[#1a1a1a] divide-y divide-[#1a1a1a]",children:C.map(e=>(0,t.jsx)("div",{onClick:()=>h(e),className:"p-4 hover:bg-[#1a1a1a]/50 transition-colors cursor-pointer",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:["#",e.id.slice(0,8)]}),(0,t.jsx)("span",{className:"text-[#888888] text-sm ml-3 font-[family-name:var(--font-montserrat)]",children:c[e.type]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("span",{className:`px-2 py-0.5 text-xs border ${l[e.status]} font-[family-name:var(--font-montserrat)]`,children:e.status}),(0,t.jsx)("span",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:A(e.createdAt)}),(0,t.jsx)("span",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:k(e.pricing.totalAmount)})]})]})},e.id))})]})]}),p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-[#111111] border-b border-[#1a1a1a] px-6 py-4 flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"text-xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5]",children:["Order #",p.id.slice(0,8)]}),(0,t.jsx)("button",{onClick:()=>h(null),className:"text-[#888888] hover:text-[#f5f5f5]",children:"✕"})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("span",{className:`inline-block px-4 py-2 text-sm border ${l[p.status]} font-[family-name:var(--font-montserrat)]`,children:o[p.status]})}),(0,t.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,t.jsx)("p",{className:"text-xs text-[#666666] mb-1 font-[family-name:var(--font-montserrat)]",children:"Order Type"}),(0,t.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)]",children:c[p.type]})]}),p.items&&p.items.length>0&&(0,t.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,t.jsxs)("p",{className:"text-xs text-[#666666] mb-3 font-[family-name:var(--font-montserrat)]",children:["Items (",p.items.reduce((e,t)=>e+t.quantity,0)," total)"]}),(0,t.jsx)("div",{className:"space-y-4",children:p.items.map((e,a)=>(0,t.jsxs)("div",{className:"flex gap-4 pb-4 border-b border-[#1a1a1a] last:border-b-0 last:pb-0",children:[e.image?(0,t.jsxs)("button",{onClick:()=>N(e.image||null),className:"w-20 h-20 flex-shrink-0 bg-[#111111] border border-[#1a1a1a] overflow-hidden hover:border-[#c9a962] transition-colors group relative",children:[(0,t.jsx)("img",{src:e.image,alt:e.productName,className:"w-full h-full object-cover"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}):(0,t.jsx)("div",{className:"w-20 h-20 flex-shrink-0 bg-[#111111] border border-[#1a1a1a] flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-[#2a2a2a]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsx)("p",{className:"text-[#f5f5f5] font-[family-name:var(--font-montserrat)] text-sm",children:e.productName}),e.sku&&(0,t.jsx)("span",{className:"text-[10px] text-[#c9a962] bg-[#c9a962]/10 px-2 py-0.5 font-[family-name:var(--font-montserrat)] whitespace-nowrap",children:e.sku})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-3 gap-y-1 mt-2 text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:[e.size&&(0,t.jsxs)("span",{children:["Size: ",(0,t.jsx)("span",{className:"text-[#f5f5f5]",children:e.size})]}),(0,t.jsxs)("span",{children:["Qty: ",(0,t.jsx)("span",{className:"text-[#f5f5f5]",children:e.quantity})]})]}),(0,t.jsx)("p",{className:"text-[#c9a962] text-sm mt-2 font-[family-name:var(--font-montserrat)] font-medium",children:k(e.price*e.quantity)})]})]},a))})]}),p.serviceDetails&&(0,t.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,t.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"Service Details"}),p.serviceDetails.styleDescription&&(0,t.jsx)("p",{className:"text-[#f5f5f5] text-sm mb-2 font-[family-name:var(--font-montserrat)]",children:p.serviceDetails.styleDescription}),(0,t.jsxs)("p",{className:"text-[#888888] text-sm font-[family-name:var(--font-montserrat)]",children:["Fabric:"," ",p.serviceDetails.fabricProvided?"Provided by you":"Studio fabric"]})]}),(0,t.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,t.jsx)("p",{className:"text-xs text-[#666666] mb-3 font-[family-name:var(--font-montserrat)]",children:"Payment Summary"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm font-[family-name:var(--font-montserrat)]",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-[#888888]",children:"Subtotal"}),(0,t.jsx)("span",{className:"text-[#f5f5f5]",children:k(p.pricing.subtotal)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-[#888888]",children:"Delivery"}),(0,t.jsx)("span",{className:"text-[#f5f5f5]",children:p.pricing.deliveryFee>0?k(p.pricing.deliveryFee):"Free"})]}),(0,t.jsxs)("div",{className:"flex justify-between pt-2 border-t border-[#1a1a1a]",children:[(0,t.jsx)("span",{className:"text-[#f5f5f5] font-medium",children:"Total"}),(0,t.jsx)("span",{className:"text-[#c9a962]",children:k(p.pricing.totalAmount)})]}),p.pricing.depositAmount&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs pt-2",children:[(0,t.jsx)("span",{className:"text-[#888888]",children:"Deposit"}),(0,t.jsxs)("span",{className:p.pricing.depositPaid?"text-green-400":"text-yellow-400",children:[k(p.pricing.depositAmount)," ",p.pricing.depositPaid?"(Paid)":"(Pending)"]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-[#888888]",children:"Balance"}),(0,t.jsxs)("span",{className:p.pricing.balancePaid?"text-green-400":"text-yellow-400",children:[k(p.pricing.balanceAmount||0)," ",p.pricing.balancePaid?"(Paid)":"(Pending)"]})]})]})]}),"cancelled"!==p.status&&"delivered"!==p.status&&S(p)&&(0,t.jsx)("button",{onClick:O,disabled:g,className:"w-full mt-4 bg-[#c9a962] text-[#0a0a0a] py-3 text-sm tracking-[0.1em] uppercase font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors disabled:opacity-50",children:g?"Processing...":(0,t.jsxs)(t.Fragment,{children:["Pay ",S(p)?.type==="deposit"?"Deposit":S(p)?.type==="balance"?"Balance":""," Now - ",k(S(p)?.amount||0)]})})]}),(0,t.jsxs)("div",{className:"bg-[#0a0a0a] p-4 border border-[#1a1a1a]",children:[(0,t.jsx)("p",{className:"text-xs text-[#666666] mb-2 font-[family-name:var(--font-montserrat)]",children:"pickup"===p.deliveryMethod?"Pickup Location":"Delivery Address"}),"pickup"===p.deliveryMethod?(0,t.jsx)("p",{className:"text-[#f5f5f5] text-sm font-[family-name:var(--font-montserrat)]",children:"Nifemii Abe Studio"}):p.deliveryAddress&&(0,t.jsxs)("p",{className:"text-[#f5f5f5] text-sm font-[family-name:var(--font-montserrat)]",children:[p.deliveryAddress.street,","," ",p.deliveryAddress.city,","," ",p.deliveryAddress.state]})]}),(0,t.jsxs)("div",{className:"text-center text-sm text-[#888888] font-[family-name:var(--font-montserrat)]",children:["Order placed on ",A(p.createdAt)]}),"pending"===p.status&&!u&&(0,t.jsxs)("div",{className:"pt-4 border-t border-[#1a1a1a]",children:[(0,t.jsx)("button",{onClick:()=>b(!0),className:"w-full border border-red-500/50 text-red-400 py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-red-500/10 transition-colors",children:"Cancel Order"}),(0,t.jsx)("p",{className:"text-xs text-[#666666] text-center mt-2 font-[family-name:var(--font-montserrat)]",children:"You can only cancel orders that haven't been confirmed yet"})]}),u&&(0,t.jsxs)("div",{className:"pt-4 border-t border-[#1a1a1a] bg-red-500/10 -mx-6 -mb-6 p-6",children:[(0,t.jsx)("p",{className:"text-red-400 text-sm font-[family-name:var(--font-montserrat)] mb-4 text-center",children:"Are you sure you want to cancel this order? This action cannot be undone."}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>b(!1),disabled:y,className:"flex-1 border border-[#2a2a2a] text-[#f5f5f5] py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-[#1a1a1a] transition-colors disabled:opacity-50",children:"Keep Order"}),(0,t.jsx)("button",{onClick:D,disabled:y,className:"flex-1 bg-red-500 text-white py-2 text-sm font-[family-name:var(--font-montserrat)] hover:bg-red-600 transition-colors disabled:opacity-50",children:y?"Cancelling...":"Yes, Cancel"})]})]})]})]})}),j&&(0,t.jsxs)("div",{className:"fixed inset-0 bg-black/90 z-[60] flex items-center justify-center p-4",onClick:()=>N(null),children:[(0,t.jsx)("button",{onClick:()=>N(null),className:"absolute top-4 right-4 text-white/80 hover:text-white transition-colors",children:(0,t.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,t.jsx)("img",{src:j,alt:"Product",className:"max-w-full max-h-[85vh] object-contain",onClick:e=>e.stopPropagation()})]})]})}e.s(["default",()=>d])}]);