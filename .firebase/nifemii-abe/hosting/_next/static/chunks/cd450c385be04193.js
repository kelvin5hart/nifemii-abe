(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40880,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(22016);e.i(36180);var n=e.i(98925),o=e.i(59141);function i(){let e=(0,a.useSearchParams)(),i=(0,a.useRouter)(),[c,l]=(0,r.useState)("loading"),[d,f]=(0,r.useState)(""),m=e.get("reference"),u=e.get("trxref"),h=m||u;return(0,r.useEffect)(()=>{(async()=>{if(!h){l("failed"),f("No payment reference found");return}try{let e=await fetch(`/api/paystack/verify?reference=${h}`),t=await e.json();if(!e.ok)throw Error(t.error||"Verification failed");if("success"===t.status){let e=t.metadata?.orderId;if(e)try{await (0,n.updateDoc)((0,n.doc)(o.db,"orders",e),{paymentStatus:"paid",paymentReference:h,paidAt:n.Timestamp.now(),status:"confirmed",updatedAt:n.Timestamp.now()})}catch(e){console.warn("Order update failed (webhook may have handled it):",e)}l("success"),setTimeout(()=>{i.push(`/checkout/success?orderId=${e||""}&paid=true`)},2e3)}else l("failed"),f("Payment was not successful")}catch(e){console.error("Verification error:",e),l("failed"),f(e instanceof Error?e.message:"Failed to verify payment")}})()},[h,i]),(0,t.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] pt-24 pb-16 flex items-center justify-center",children:(0,t.jsx)("div",{className:"max-w-md w-full mx-4",children:(0,t.jsxs)("div",{className:"bg-[#111111] border border-[#1a1a1a] p-8 text-center",children:["loading"===c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-[#c9a962] border-t-transparent rounded-full animate-spin mx-auto mb-6"}),(0,t.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-2",children:"Verifying Payment"}),(0,t.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)]",children:"Please wait while we confirm your payment..."})]}),"success"===c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,t.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-2",children:"Payment Successful!"}),(0,t.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)]",children:"Redirecting you to your order confirmation..."})]}),"failed"===c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,t.jsx)("h1",{className:"text-2xl font-[family-name:var(--font-cormorant)] text-[#f5f5f5] mb-2",children:"Payment Verification Failed"}),(0,t.jsx)("p",{className:"text-[#888888] font-[family-name:var(--font-montserrat)] mb-6",children:d}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(s.default,{href:"/checkout",className:"block w-full bg-[#c9a962] text-[#0a0a0a] py-3 text-sm tracking-[0.1em] uppercase font-[family-name:var(--font-montserrat)] hover:bg-[#d4b87a] transition-colors",children:"Try Again"}),(0,t.jsx)(s.default,{href:"/shop",className:"block w-full border border-[#2a2a2a] text-[#888888] py-3 text-sm font-[family-name:var(--font-montserrat)] hover:border-[#3a3a3a] hover:text-[#f5f5f5] transition-colors",children:"Continue Shopping"})]})]})]})})})}function c(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] pt-24 pb-16 flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-[#c9a962] border-t-transparent rounded-full animate-spin"})}),children:(0,t.jsx)(i,{})})}e.s(["default",()=>c])}]);